<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Spend time or hit out? How have different strategies affected teams’ winning chances?">

<title>Roshan Prizak - Batter strategies and their impacts in the IPL</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script type="module" src="../../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title"><strong>Roshan</strong> Prizak</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/roshanprizak"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/roshanprizak"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/roshanprizak/"><i class="bi bi-instagram" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../../projects.html" aria-current="page">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../projects/cricket_analytics/cricket_analytics.html">
 <span class="menu-text">Cricket</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../projects/the_india_project/the_india_project.html">
 <span class="menu-text">The India Project</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../projects/the_vienna_project/the_vienna_project.html">
 <span class="menu-text">The Vienna Project</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../projects/health/health.html">
 <span class="menu-text">Health</span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Batter strategies and their impacts in the IPL</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block">Batter strategies and their impacts in the IPL</h1>
                  <div>
        <div class="description">
          Spend time or hit out? How have different strategies affected teams’ winning chances?
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Data science</div>
                <div class="quarto-category">Cricket</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../projects.html" class="sidebar-item-text sidebar-link">Projects Overview</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../projects/health/health.html" class="sidebar-item-text sidebar-link">Health</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../projects/health/wha_resolutions/analyze_keywords.html" class="sidebar-item-text sidebar-link">WHA resolutions</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../projects/the_vienna_project/the_vienna_project.html" class="sidebar-item-text sidebar-link">The Vienna Project</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../projects/the_vienna_project/closest_public_transport/closest_public_transport.html" class="sidebar-item-text sidebar-link">Public transport access</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../projects/the_india_project/the_india_project.html" class="sidebar-item-text sidebar-link">The India Project</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../projects/the_india_project/car_prices_india/car_prices_india.html" class="sidebar-item-text sidebar-link">Cars &amp; airbags</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../projects/the_india_project/movies_india/movies_india.html" class="sidebar-item-text sidebar-link">Movies</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../projects/cricket_analytics/cricket_analytics.html" class="sidebar-item-text sidebar-link">Cricket Analytics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../projects/cricket_analytics/ipl_batters_strategies/ipl_batters_strategies.html" class="sidebar-item-text sidebar-link active">IPL batter strategies</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#the-trade-off-between-strike-rate-and-risk" id="toc-the-trade-off-between-strike-rate-and-risk" class="nav-link" data-scroll-target="#the-trade-off-between-strike-rate-and-risk">The trade-off between strike-rate and risk</a></li>
  <li><a href="#strategy-differences-between-winning-and-losing" id="toc-strategy-differences-between-winning-and-losing" class="nav-link" data-scroll-target="#strategy-differences-between-winning-and-losing">Strategy differences between winning and losing</a></li>
  <li><a href="#interactive-plots" id="toc-interactive-plots" class="nav-link" data-scroll-target="#interactive-plots">Interactive Plots</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The role of batters in cricket is to make as many runs as possible for their team, and sometimes, especially in test cricket, to also play as many balls as possible. In T20 cricket, due to the short format, batters can take more risks than in the other longer formats, and hence an increasing emphasis is on scoring as many runs as possible in as little balls as possible. Of course, this doesn’t automatically imply that batters always take risks as it can mean that the team runs out of specialized batters with many overs still left to play. Batters take more risks than in ODIs or tests, thereby allowing quicker scoring, while also spacing out these risks appropriately, to be able to playing out the allotted 20 overs. T20 cricket has also led to very specialized roles for batters and a lot of emphasis is given to ensuring that the best hitters get enough balls to showcase their skills.</p>
<p>In the last 14 years since IPL began in 2008, batters in the debatably world’s premier T20 tournament have employed various strategies to make these quick runs. Depending on whether the batter is an opener, a middle-order batter or a finisher, different teams and batters have developed diverse templates. In this project, I investigated individual batter templates and strategies, and their impact on the team’s winning consequences.</p>
</section>
<section id="the-trade-off-between-strike-rate-and-risk" class="level2">
<h2 class="anchored" data-anchor-id="the-trade-off-between-strike-rate-and-risk">The trade-off between strike-rate and risk</h2>
<p>The trade-off between risk and strike-rate takes the center stage in individual batter strategies. A batter willing to take more risk has access to a wider range of shots for each ball, often diverging employing shots that diverge from the prescribed shots in the coaching manual. Some batters like Andre Russell score quick runs while taking more risks. This increases their chance of getting out each ball, and thereby they end up playing fewer balls. Such finishers usually come later in the innings when there aren’t a lot of balls left. Some teams like the Kolkata Knight Riders have often sent out “pinch hitters” like Sunil Narine earlier in the innings, often as an opener. On the other hand, batters like AB de Villiers and Jos Buttler switch gears between low and moderate risk. But even at the highest risk, the emphasis is slightly more on surviving to play another ball than is for batters like Andre Russell. More conventional batters like Mike Hussey, Tendulkar and Kallis rely heavily on a risk-minimal approach unless the situation strongly demands otherwise.</p>
<p><a href="strike-rates_balls-faced_allbatters_ipl_mobile.png" class="lightbox" title="Strike-rates vs balls faced" data-gallery="quarto-lightbox-gallery-1"><img src="strike-rates_balls-faced_allbatters_ipl_mobile.png" class="mobile-only zoomable img-fluid" alt="Strike-rates vs balls faced"></a> <a href="strike-rates_balls-faced_allbatters_ipl_desktop.png" class="lightbox" title="Strike-rates vs balls faced" data-gallery="quarto-lightbox-gallery-2"><img src="strike-rates_balls-faced_allbatters_ipl_desktop.png" class="desktop-only zoomable img-fluid" alt="Strike-rates vs balls faced"></a></p>
<p>The figure above illustrates some aspects of this trade-off. Keeping tail-enders aside, notice that batters are spread on the diagonal from the top left to the bottom right. Classical players like Mike Hussey, Kallis, Tendulkar and Gaikwad are in the top left quarter - they play more balls than most others and hit at a lower strike-rate than most others. As we move through the large group of unnamed batters marked in blue, we find another group of players like Maxwell, Pollard and Hardik Pandya who play fewer balls than most others and hit at a higher rate than most others. Some notable exceptions are batters who seem to escape this trade-off, or perhaps push it to its limits - KL Rahul, Jos Buttler, AB de Villiers, Warner, Gayle, Russell and the like.</p>
<p>Openers play more balls than the other batter types while also exhibiting a wide range of strike-rates. For example, Gaikwad’s average strike-rate is just short of 100 and Jos Buttler’s is around 135. Gaikwad, however, typically plays a few more balls than Jos Buttler. How do these different strategies impact the match outcome?</p>
</section>
<section id="strategy-differences-between-winning-and-losing" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="strategy-differences-between-winning-and-losing">Strategy differences between winning and losing</h2>
<p>Separating the innings played by each batter into two groups based on whether their team won or lost the match, we can measure how different the batters strategies are in the two groups.</p>
<p>Instead of measuring the difference between mean strike-rate in wins and mean strike-rate in losses for each batter, we use <em>percentile scores</em>. The mean percentile score from strike-rates in wins (losses) tells us overall in all innings, how often the batter scores slower than they typically score at in wins (losses). The difference between these two values (wins minus losses) quantifies the typical increase (if positive) or decrease (if negative) of strike-rates from losses to wins. A similar logic applies for balls faced - the difference between mean percentile scores in wins and losses quantifies the typical increase (if positive) or decrease (if negative) in the number of balls faced from losses to wins.</p>
<p><a href="match-outcomes_strike-rates_balls-faced_allbatters_ipl_mobile.png" class="lightbox" title="Differences in strike-rates and balls faced between wins and losses" data-gallery="quarto-lightbox-gallery-3"><img src="match-outcomes_strike-rates_balls-faced_allbatters_ipl_mobile.png" class="mobile-only img-fluid" alt="Differences in strike-rates and balls faced between wins and losses"></a> <a href="match-outcomes_strike-rates_balls-faced_allbatters_ipl_desktop.png" class="lightbox" title="Differences in strike-rates and balls faced between wins and losses" data-gallery="quarto-lightbox-gallery-4"><img src="match-outcomes_strike-rates_balls-faced_allbatters_ipl_desktop.png" class="desktop-only img-fluid" alt="Differences in strike-rates and balls faced between wins and losses"></a></p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>How is the calculation done?</strong> Percentile scores transform data into values between 0 and 1, making comparisons across datasets with different ranges easier. The percentile score of a particular value is the fraction of data that is smaller than the value. We do this for each batter separately for both strike-rates and balls faced. The percentile score of a particular strike-rate (in some particular innings) of a batter tells us how often the batter has scored slower than in that innings. So for the batter’s IPL career-best strike-rate, the percentile score would be 1 (signifying that the batter plays slower in all other innings), and for the batter’s IPL career-worst strike rate, the percentile score would be 0.</p>
</div></div></section>
<section id="interactive-plots" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="interactive-plots">Interactive Plots</h2>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="47" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 46;"><span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"data/ipl_batter_SR_balls.json"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="51" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 50;"><span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>all_batter_names <span class="op">=</span> data<span class="op">.</span><span class="fu">map</span>(row <span class="kw">=&gt;</span> row<span class="op">.</span><span class="at">Name</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<p>Here is an interactive version that presents these features of strike-rates, balls faced and their differences between wins and losses. You can select a subset of batting positions on the right to limit display to those positions. Hovering over a point would reveal the batter information, along with their average performance in wins and losses. When you hover, two small plots pop up on the right edge that reveal how strike-rates and balls faced differ between wins and losses in all individual innings of the batter. After hovering, you can click to label the batter even when you move the mouse away from the point.</p>
<div class="column-page-right">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="59" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 58;"><span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co">/* ----------------------------------------------------------</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="co">Interactive plot showing average strike-rates and balls faced</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="co">-------------------------------------------------------------*/</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Setting up the overall chart dimensions</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> ({<span class="dt">top</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">150</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">60</span>})</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> visWidth <span class="op">=</span> <span class="dv">450</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> visHeight <span class="op">=</span> <span class="dv">450</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> textColor <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">"p"</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"color"</span>)</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> greyTextColor <span class="op">=</span> <span class="st">"#212529"</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Setting up x and y scales to map from data values to pixel values</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> extentSR <span class="op">=</span> [d3<span class="op">.</span><span class="fu">min</span>(data<span class="op">,</span> <span class="kw">function</span>(d){<span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span><span class="op">.</span><span class="fu">apply</span>(<span class="bu">Math</span><span class="op">,</span> [d<span class="op">.</span><span class="at">AvSRWin</span><span class="op">,</span> d<span class="op">.</span><span class="at">AvSRLoss</span>])})<span class="op">,</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>                d3<span class="op">.</span><span class="fu">max</span>(data<span class="op">,</span> <span class="kw">function</span>(d){<span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">.</span><span class="fu">apply</span>(<span class="bu">Math</span><span class="op">,</span> [d<span class="op">.</span><span class="at">AvSRWin</span><span class="op">,</span> d<span class="op">.</span><span class="at">AvSRLoss</span>])})]<span class="op">;</span> </span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> extentBalls <span class="op">=</span> [d3<span class="op">.</span><span class="fu">min</span>(data<span class="op">,</span> <span class="kw">function</span>(d){<span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span><span class="op">.</span><span class="fu">apply</span>(<span class="bu">Math</span><span class="op">,</span> [d<span class="op">.</span><span class="at">AvBallsWin</span><span class="op">,</span> d<span class="op">.</span><span class="at">AvBallsLoss</span>])})<span class="op">,</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>                d3<span class="op">.</span><span class="fu">max</span>(data<span class="op">,</span> <span class="kw">function</span>(d){<span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">.</span><span class="fu">apply</span>(<span class="bu">Math</span><span class="op">,</span> [d<span class="op">.</span><span class="at">AvBallsWin</span><span class="op">,</span> d<span class="op">.</span><span class="at">AvBallsLoss</span>])})]<span class="op">;</span> </span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Linear x-scale, domain and range set</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">domain</span>(extentSR)<span class="op">.</span><span class="fu">nice</span>()</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> visWidth])<span class="op">;</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Linear y-scale, domain and range set</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">domain</span>(extentBalls)<span class="op">.</span><span class="fu">nice</span>()</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>([visHeight<span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating the x-axis and the y-axis, and their labels</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating the x-axis</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xAxis <span class="op">=</span> (g<span class="op">,</span> scale<span class="op">,</span> label) <span class="kw">=&gt;</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span>visHeight<span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>        <span class="co">// add axis</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisBottom</span>(scale))</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>      <span class="co">// add label</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> visWidth <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"18"</span>)</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(label)</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating the y-axis</span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yAxis <span class="op">=</span> (g<span class="op">,</span> scale<span class="op">,</span> label) <span class="kw">=&gt;</span> </span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>    <span class="co">// add axis</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisLeft</span>(scale))</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>      <span class="co">// add label</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"rotate(-90)"</span>)</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="op">-</span>visHeight<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="op">-</span>margin<span class="op">.</span><span class="at">left</span><span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"18"</span>)</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(label)</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating the svg inside the visualization margins of the chart: this is where things can be drawn</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> visWidth <span class="op">+</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">right</span>)</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> visHeight <span class="op">+</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">bottom</span>)<span class="op">;</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* svg.append("rect")</span></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a><span class="co">    .attr("width", "100%")</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a><span class="co">    .attr("height", "100%")</span></span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a><span class="co">    .attr("fill", "#ffffff"); */</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating a main group to add things to visualize</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> g <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Attach axes to the main group</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">call</span>(xAxis<span class="op">,</span> x<span class="op">,</span> <span class="st">"Average strike-rate in innings →"</span>)<span class="op">;</span></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">call</span>(yAxis<span class="op">,</span> y<span class="op">,</span> <span class="st">"Average no. of balls faced in innings →"</span>)<span class="op">;</span></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Change axes tick label fontsize</span></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Drawing grid lines</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> grid <span class="op">=</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)<span class="op">;</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>  grid<span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> visWidth)</span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> visHeight)</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'white'</span>)<span class="op">;</span></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> yLines <span class="op">=</span> grid<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'line'</span>)<span class="op">;</span></span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> xLines <span class="op">=</span> grid<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'line'</span>)<span class="op">;</span></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawGridLines</span>(x<span class="op">,</span> y) {</span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>    yLines <span class="op">=</span> yLines<span class="op">.</span><span class="fu">data</span>(y<span class="op">.</span><span class="fu">ticks</span>())</span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">'line'</span>)</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'#d3d3d3'</span>)</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x1'</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x2'</span><span class="op">,</span> visWidth)</span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y1'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fu">y</span>(d))</span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y2'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fu">y</span>(d))<span class="op">;</span></span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>    xLines <span class="op">=</span> xLines<span class="op">.</span><span class="fu">data</span>(x<span class="op">.</span><span class="fu">ticks</span>())</span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">'line'</span>)</span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'#d3d3d3'</span>)</span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x1'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fu">x</span>(d))</span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x2'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fu">x</span>(d))</span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y1'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="dv">0</span>)</span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y2'</span><span class="op">,</span> d <span class="kw">=&gt;</span> visHeight)<span class="op">;</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Allows to re-draw grid lines whenever necessary: like zooming in or updating the domains of the x and y axes</span></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawGridLines</span>(x<span class="op">,</span> y)<span class="op">;</span></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Setting up a clipPath to hide data points outside of the visualization area </span></span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">'clipPath'</span>)</span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'id'</span><span class="op">,</span> <span class="st">'border'</span>)</span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> visWidth)</span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> visHeight)<span class="op">;</span></span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> visWidth)</span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> visHeight)</span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#000000"</span>)</span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)<span class="op">;</span></span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Setting up a group containing the base scatter points</span></span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> baseCirclesGroup <span class="op">=</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'clip-path'</span><span class="op">,</span> <span class="st">'url(#border)'</span>)<span class="op">;</span></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Setting up a group containing the hover graphic elements</span></span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> hoverElementsGroup <span class="op">=</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'clip-path'</span><span class="op">,</span> <span class="st">'url(#border)'</span>)<span class="op">;</span></span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating a tooltip that is hidden by default</span></span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tooltip <span class="op">=</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"tp"</span>)</span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)<span class="op">;</span></span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating the x-axis</span></span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xAxisSide <span class="op">=</span> (g<span class="op">,</span> scale) <span class="kw">=&gt;</span></span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0, 100)`</span>)</span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a>        <span class="co">// add axis</span></span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisBottom</span>(scale)<span class="op">.</span><span class="fu">ticks</span>(<span class="dv">10</span>))<span class="op">;</span></span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>        <span class="co">// .call(g =&gt; g.select(".domain").remove());</span></span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating the y-axis</span></span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yAxisSide <span class="op">=</span> (g<span class="op">,</span> scale) <span class="kw">=&gt;</span> </span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>    <span class="co">// add axis</span></span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisLeft</span>(scale)<span class="op">.</span><span class="fu">ticks</span>(<span class="dv">10</span>))<span class="op">;</span></span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>    <span class="co">//.call(g =&gt; g.select(".domain").remove());</span></span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sideAxisX <span class="op">=</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> visWidth <span class="op">+</span> <span class="dv">30</span></span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sideAxisY <span class="op">=</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> <span class="dv">120</span></span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sideAxisGroupTop <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"side_axis"</span>)</span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>sideAxisX<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>sideAxisY<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a>  sideAxisGroupTop<span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> <span class="dv">100</span>)</span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">100</span>)</span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#000000"</span>)</span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)<span class="op">;</span></span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sideAxisYAdded <span class="op">=</span> sideAxisY <span class="op">+</span> <span class="dv">120</span></span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sideAxisGroupBottom <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"side_axis"</span>)</span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>sideAxisX<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>sideAxisYAdded<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a>  sideAxisGroupBottom<span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> <span class="dv">100</span>)</span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">100</span>)</span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#000000"</span>)</span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)<span class="op">;</span></span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> all_SR <span class="op">=</span> []</span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> all_balls <span class="op">=</span> []</span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">range</span>(data<span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(xx<span class="op">,</span> i) {</span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a>    all_SR <span class="op">=</span> d3<span class="op">.</span><span class="fu">merge</span>([all_SR<span class="op">,</span> data[xx]<span class="op">.</span><span class="at">SR</span>])</span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a>    all_balls <span class="op">=</span> d3<span class="op">.</span><span class="fu">merge</span>([all_balls<span class="op">,</span> data[xx]<span class="op">.</span><span class="at">Balls</span>]) </span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> minSR <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(all_SR)</span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> maxSR <span class="op">=</span> d3<span class="op">.</span><span class="fu">quantile</span>(all_SR<span class="op">,</span> <span class="fl">0.99</span>)</span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> minBalls <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(all_balls)</span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> maxBalls <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(all_balls)</span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xSide <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">domain</span>([minSR<span class="op">,</span> maxSR])</span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])<span class="op">;</span></span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Linear y-scale, domain and range set</span></span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> ySide <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">domain</span>([minBalls<span class="op">,</span> maxBalls])</span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>([<span class="dv">100</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Setting up a group containing the base scatter points</span></span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sideCirclesGroupTop <span class="op">=</span> sideAxisGroupTop<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)<span class="op">;</span></span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sideCirclesGroupBottom <span class="op">=</span> sideAxisGroupBottom<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)<span class="op">;</span></span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Setting up some values before starting to plot</span></span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> baseRadius <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> BattingPositions <span class="op">=</span> [<span class="st">"Openers"</span><span class="op">,</span> <span class="st">"Middle-order"</span><span class="op">,</span> <span class="st">"Finishers"</span><span class="op">,</span> <span class="st">"Tail-enders"</span>]</span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> battingPositionColor <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleOrdinal</span>()</span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>(BattingPositions)</span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(d3<span class="op">.</span><span class="at">schemeCategory10</span>)<span class="op">;</span></span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Drawing the base scatter points by attaching it to the data</span></span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawPoints</span>(in_data) {</span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> meanBalls <span class="op">=</span> d3<span class="op">.</span><span class="fu">mean</span>(in_data<span class="op">,</span> <span class="kw">function</span>(d) {<span class="cf">return</span> d<span class="op">.</span><span class="at">AvBalls</span>})<span class="op">;</span></span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> xMin <span class="op">=</span> x<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> xMax <span class="op">=</span> x<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> meanSR <span class="op">=</span> d3<span class="op">.</span><span class="fu">mean</span>(in_data<span class="op">,</span> <span class="kw">function</span>(d) {<span class="cf">return</span> d<span class="op">.</span><span class="at">AvSR</span>})<span class="op">;</span></span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> yMin <span class="op">=</span> y<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> yMax <span class="op">=</span> y<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Select all circles in the group and append a data point to each</span></span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> baseCircles <span class="op">=</span> baseCirclesGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'circle'</span>)</span>
<span id="cb3-290"><a href="#cb3-290" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(in_data)</span>
<span id="cb3-291"><a href="#cb3-291" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">'circle'</span>)</span>
<span id="cb3-292"><a href="#cb3-292" aria-hidden="true" tabindex="-1"></a>        <span class="co">// draw points</span></span>
<span id="cb3-293"><a href="#cb3-293" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">AvSR</span>))</span>
<span id="cb3-294"><a href="#cb3-294" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">AvBalls</span>))</span>
<span id="cb3-295"><a href="#cb3-295" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span>  <span class="fu">battingPositionColor</span>(d<span class="op">.</span><span class="at">BattingPosition</span>))</span>
<span id="cb3-296"><a href="#cb3-296" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> baseRadius)</span>
<span id="cb3-297"><a href="#cb3-297" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-298"><a href="#cb3-298" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb3-299"><a href="#cb3-299" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'opacity'</span><span class="op">,</span> <span class="fl">0.5</span>)</span>
<span id="cb3-300"><a href="#cb3-300" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Interactive functions:</span></span>
<span id="cb3-301"><a href="#cb3-301" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseenter"</span><span class="op">,</span> mouseEnter)</span>
<span id="cb3-302"><a href="#cb3-302" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseleave"</span><span class="op">,</span> mouseLeave)</span>
<span id="cb3-303"><a href="#cb3-303" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> clicked)<span class="op">;</span></span>
<span id="cb3-304"><a href="#cb3-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-305"><a href="#cb3-305" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Adding a horizontal line</span></span>
<span id="cb3-306"><a href="#cb3-306" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">append</span>(<span class="st">'line'</span>)</span>
<span id="cb3-307"><a href="#cb3-307" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"mean_balls"</span>)</span>
<span id="cb3-308"><a href="#cb3-308" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">x</span>(xMin))</span>
<span id="cb3-309"><a href="#cb3-309" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="fu">y</span>(meanBalls))</span>
<span id="cb3-310"><a href="#cb3-310" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">x</span>(xMax))</span>
<span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fu">y</span>(meanBalls))</span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb3-313"><a href="#cb3-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-314"><a href="#cb3-314" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Adding a vertical line</span></span>
<span id="cb3-315"><a href="#cb3-315" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">append</span>(<span class="st">'line'</span>)</span>
<span id="cb3-316"><a href="#cb3-316" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"mean_sr"</span>)</span>
<span id="cb3-317"><a href="#cb3-317" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">x</span>(meanSR))</span>
<span id="cb3-318"><a href="#cb3-318" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="fu">y</span>(yMin))</span>
<span id="cb3-319"><a href="#cb3-319" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">x</span>(meanSR))</span>
<span id="cb3-320"><a href="#cb3-320" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fu">y</span>(yMax))</span>
<span id="cb3-321"><a href="#cb3-321" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb3-322"><a href="#cb3-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-323"><a href="#cb3-323" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-324"><a href="#cb3-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-325"><a href="#cb3-325" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Function to draw equi-run lines, given an array of runs</span></span>
<span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> line <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> SR_linspace</span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawEquiRunLines</span>(eqrs) {</span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a>    SR_linspace <span class="op">=</span> d3<span class="op">.</span><span class="fu">ticks</span>(x<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">0</span>]<span class="op">,</span> x<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>]<span class="op">,</span> <span class="dv">1000</span>)<span class="op">;</span>    </span>
<span id="cb3-330"><a href="#cb3-330" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> balls_eqr</span>
<span id="cb3-331"><a href="#cb3-331" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> eqr_points</span>
<span id="cb3-332"><a href="#cb3-332" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Equi-run lines</span></span>
<span id="cb3-333"><a href="#cb3-333" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> eqrs<span class="op">.</span><span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) { </span>
<span id="cb3-334"><a href="#cb3-334" aria-hidden="true" tabindex="-1"></a>      balls_eqr <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>()<span class="op">;</span></span>
<span id="cb3-335"><a href="#cb3-335" aria-hidden="true" tabindex="-1"></a>      eqr_points <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>()<span class="op">;</span></span>
<span id="cb3-336"><a href="#cb3-336" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> SR_linspace<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) { </span>
<span id="cb3-337"><a href="#cb3-337" aria-hidden="true" tabindex="-1"></a>        balls_eqr<span class="op">.</span><span class="fu">push</span>(eqrs[j]<span class="op">*</span><span class="dv">100</span><span class="op">/</span>SR_linspace[i])<span class="op">;</span></span>
<span id="cb3-338"><a href="#cb3-338" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (balls_eqr[i]<span class="op">&gt;=</span>y<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">0</span>] <span class="op">&amp;&amp;</span> balls_eqr[i]<span class="op">&lt;=</span>y<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>]) {</span>
<span id="cb3-339"><a href="#cb3-339" aria-hidden="true" tabindex="-1"></a>          eqr_points<span class="op">.</span><span class="fu">push</span>([<span class="fu">x</span>(SR_linspace[i])<span class="op">,</span> <span class="fu">y</span>(balls_eqr[i])])<span class="op">;</span></span>
<span id="cb3-340"><a href="#cb3-340" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-341"><a href="#cb3-341" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-342"><a href="#cb3-342" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-343"><a href="#cb3-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-344"><a href="#cb3-344" aria-hidden="true" tabindex="-1"></a>      g<span class="op">.</span><span class="fu">append</span>(<span class="st">'path'</span>)</span>
<span id="cb3-345"><a href="#cb3-345" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"main_eqr_lines"</span>)</span>
<span id="cb3-346"><a href="#cb3-346" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> <span class="fu">line</span>(eqr_points))</span>
<span id="cb3-347"><a href="#cb3-347" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'#a3a3a3'</span>)</span>
<span id="cb3-348"><a href="#cb3-348" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> (<span class="st">"10,3"</span>))</span>
<span id="cb3-349"><a href="#cb3-349" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)<span class="op">;</span></span>
<span id="cb3-350"><a href="#cb3-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-351"><a href="#cb3-351" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Labeling the equi-run lines on the right-side of the plot</span></span>
<span id="cb3-352"><a href="#cb3-352" aria-hidden="true" tabindex="-1"></a>      g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-353"><a href="#cb3-353" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"main_eqr_run_labels"</span>)</span>
<span id="cb3-354"><a href="#cb3-354" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="st">"0.5em"</span>)</span>
<span id="cb3-355"><a href="#cb3-355" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-356"><a href="#cb3-356" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-357"><a href="#cb3-357" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb3-358"><a href="#cb3-358" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">y</span>(eqrs[j]<span class="op">*</span><span class="dv">100</span><span class="op">/</span>(x<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>]))) <span class="co">// offset it from the edge of the rectangle</span></span>
<span id="cb3-359"><a href="#cb3-359" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(x<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>])) <span class="co">// offset it from the edge of the rectangle</span></span>
<span id="cb3-360"><a href="#cb3-360" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-361"><a href="#cb3-361" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".0f"</span>)(eqrs[j])<span class="op">+</span><span class="st">" runs"</span>)<span class="op">;</span></span>
<span id="cb3-362"><a href="#cb3-362" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-363"><a href="#cb3-363" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-364"><a href="#cb3-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-365"><a href="#cb3-365" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Calling function to draw equi-run lines</span></span>
<span id="cb3-366"><a href="#cb3-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawEquiRunLines</span>([<span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">40</span><span class="op">,</span> <span class="dv">50</span>])</span>
<span id="cb3-367"><a href="#cb3-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-368"><a href="#cb3-368" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Calling function to draw the base scatter plot on the given axes</span></span>
<span id="cb3-369"><a href="#cb3-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawPoints</span>(data)</span>
<span id="cb3-370"><a href="#cb3-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-371"><a href="#cb3-371" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">dragstarted</span>() {</span>
<span id="cb3-372"><a href="#cb3-372" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb3-373"><a href="#cb3-373" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-374"><a href="#cb3-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-375"><a href="#cb3-375" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">dragged</span>(<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb3-376"><a href="#cb3-376" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)<span class="op">.</span><span class="fu">raise</span>()<span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> d<span class="op">.</span><span class="at">x</span> <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">x</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> d<span class="op">.</span><span class="at">y</span> <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">y</span>)<span class="op">;</span></span>
<span id="cb3-377"><a href="#cb3-377" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-378"><a href="#cb3-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-379"><a href="#cb3-379" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">dragended</span>() {</span>
<span id="cb3-380"><a href="#cb3-380" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb3-381"><a href="#cb3-381" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-382"><a href="#cb3-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-383"><a href="#cb3-383" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> drag <span class="op">=</span> d3<span class="op">.</span><span class="fu">drag</span>()</span>
<span id="cb3-384"><a href="#cb3-384" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> dragstarted)</span>
<span id="cb3-385"><a href="#cb3-385" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> dragged)</span>
<span id="cb3-386"><a href="#cb3-386" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"end"</span><span class="op">,</span> dragended)<span class="op">;</span></span>
<span id="cb3-387"><a href="#cb3-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-388"><a href="#cb3-388" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Track which batting-positions are selected</span></span>
<span id="cb3-389"><a href="#cb3-389" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> highlighted <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>(data<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> [d<span class="op">,</span> <span class="kw">true</span>]))<span class="op">;</span></span>
<span id="cb3-390"><a href="#cb3-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-391"><a href="#cb3-391" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Function to handle mouse enter events</span></span>
<span id="cb3-392"><a href="#cb3-392" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">mouseEnter</span>(<span class="bu">event</span><span class="op">,</span> d<span class="op">,</span> i) {</span>
<span id="cb3-393"><a href="#cb3-393" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-394"><a href="#cb3-394" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Remove labeling of highlighted labels, and equi-run lines</span></span>
<span id="cb3-395"><a href="#cb3-395" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".highlighted_labels"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-396"><a href="#cb3-396" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".main_eqr_lines"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)<span class="op">;</span></span>
<span id="cb3-397"><a href="#cb3-397" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".main_eqr_run_labels"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)<span class="op">;</span></span>
<span id="cb3-398"><a href="#cb3-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-399"><a href="#cb3-399" aria-hidden="true" tabindex="-1"></a>    <span class="co">// y.domain([70,100])</span></span>
<span id="cb3-400"><a href="#cb3-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-401"><a href="#cb3-401" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Define the arrowhead marker variables</span></span>
<span id="cb3-402"><a href="#cb3-402" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> markerBoxWidth <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb3-403"><a href="#cb3-403" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> markerBoxHeight <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb3-404"><a href="#cb3-404" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> refX <span class="op">=</span> markerBoxWidth <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb3-405"><a href="#cb3-405" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> refY <span class="op">=</span> markerBoxHeight <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb3-406"><a href="#cb3-406" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> markerWidth <span class="op">=</span> markerBoxWidth <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb3-407"><a href="#cb3-407" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> markerHeight <span class="op">=</span> markerBoxHeight <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb3-408"><a href="#cb3-408" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> arrowPoints <span class="op">=</span> [[<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> [<span class="dv">10</span><span class="op">,</span> <span class="dv">5</span>]]<span class="op">;</span></span>
<span id="cb3-409"><a href="#cb3-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-410"><a href="#cb3-410" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Add the arrowhead marker definition to the svg element</span></span>
<span id="cb3-411"><a href="#cb3-411" aria-hidden="true" tabindex="-1"></a>    svg</span>
<span id="cb3-412"><a href="#cb3-412" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">'defs'</span>)</span>
<span id="cb3-413"><a href="#cb3-413" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">'marker'</span>)</span>
<span id="cb3-414"><a href="#cb3-414" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'id'</span><span class="op">,</span> <span class="st">'arrow'</span>)</span>
<span id="cb3-415"><a href="#cb3-415" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'viewBox'</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> markerBoxWidth<span class="op">,</span> markerBoxHeight])</span>
<span id="cb3-416"><a href="#cb3-416" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'refX'</span><span class="op">,</span> refX)</span>
<span id="cb3-417"><a href="#cb3-417" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'refY'</span><span class="op">,</span> refY)</span>
<span id="cb3-418"><a href="#cb3-418" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'markerWidth'</span><span class="op">,</span> markerBoxWidth)</span>
<span id="cb3-419"><a href="#cb3-419" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'markerHeight'</span><span class="op">,</span> markerBoxHeight)</span>
<span id="cb3-420"><a href="#cb3-420" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'orient'</span><span class="op">,</span> <span class="st">'auto-start-reverse'</span>)</span>
<span id="cb3-421"><a href="#cb3-421" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">'path'</span>)</span>
<span id="cb3-422"><a href="#cb3-422" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">line</span>()(arrowPoints))</span>
<span id="cb3-423"><a href="#cb3-423" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'black'</span>)<span class="op">;</span></span>
<span id="cb3-424"><a href="#cb3-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-425"><a href="#cb3-425" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Change opacity of all scatter points on hover</span></span>
<span id="cb3-426"><a href="#cb3-426" aria-hidden="true" tabindex="-1"></a>    baseCirclesGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'circle'</span>)</span>
<span id="cb3-427"><a href="#cb3-427" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-428"><a href="#cb3-428" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.75</span>)</span>
<span id="cb3-429"><a href="#cb3-429" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#d3d3d3"</span>)<span class="op">;</span></span>
<span id="cb3-430"><a href="#cb3-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-431"><a href="#cb3-431" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> eqrs <span class="op">=</span> [d<span class="op">.</span><span class="at">AvBallsLoss</span><span class="op">*</span>d<span class="op">.</span><span class="at">AvSRLoss</span><span class="op">/</span><span class="dv">100</span><span class="op">,</span> d<span class="op">.</span><span class="at">AvBalls</span><span class="op">*</span>d<span class="op">.</span><span class="at">AvSR</span><span class="op">/</span><span class="dv">100</span><span class="op">,</span> d<span class="op">.</span><span class="at">AvBallsWin</span><span class="op">*</span>d<span class="op">.</span><span class="at">AvSRWin</span><span class="op">/</span><span class="dv">100</span>]</span>
<span id="cb3-432"><a href="#cb3-432" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> loss_runs_positions <span class="op">=</span> [<span class="st">"hanging"</span><span class="op">,</span> <span class="st">"middle"</span><span class="op">,</span> <span class="st">"bottom"</span>]</span>
<span id="cb3-433"><a href="#cb3-433" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> balls_eqr</span>
<span id="cb3-434"><a href="#cb3-434" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> eqr_points</span>
<span id="cb3-435"><a href="#cb3-435" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Equi-run lines</span></span>
<span id="cb3-436"><a href="#cb3-436" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> eqrs<span class="op">.</span><span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) { </span>
<span id="cb3-437"><a href="#cb3-437" aria-hidden="true" tabindex="-1"></a>      balls_eqr <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>()<span class="op">;</span></span>
<span id="cb3-438"><a href="#cb3-438" aria-hidden="true" tabindex="-1"></a>      eqr_points <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>()<span class="op">;</span></span>
<span id="cb3-439"><a href="#cb3-439" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> SR_linspace<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) { </span>
<span id="cb3-440"><a href="#cb3-440" aria-hidden="true" tabindex="-1"></a>        balls_eqr<span class="op">.</span><span class="fu">push</span>(eqrs[j]<span class="op">*</span><span class="dv">100</span><span class="op">/</span>SR_linspace[i])<span class="op">;</span></span>
<span id="cb3-441"><a href="#cb3-441" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (balls_eqr[i]<span class="op">&gt;=</span>y<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">0</span>] <span class="op">&amp;&amp;</span> balls_eqr[i]<span class="op">&lt;=</span>y<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>]) {</span>
<span id="cb3-442"><a href="#cb3-442" aria-hidden="true" tabindex="-1"></a>          eqr_points<span class="op">.</span><span class="fu">push</span>([<span class="fu">x</span>(SR_linspace[i])<span class="op">,</span> <span class="fu">y</span>(balls_eqr[i])])<span class="op">;</span></span>
<span id="cb3-443"><a href="#cb3-443" aria-hidden="true" tabindex="-1"></a>        } </span>
<span id="cb3-444"><a href="#cb3-444" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-445"><a href="#cb3-445" aria-hidden="true" tabindex="-1"></a>      hoverElementsGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">'path'</span>)</span>
<span id="cb3-446"><a href="#cb3-446" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hover_eqr_lines"</span>)</span>
<span id="cb3-447"><a href="#cb3-447" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-448"><a href="#cb3-448" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> <span class="fu">line</span>(eqr_points))</span>
<span id="cb3-449"><a href="#cb3-449" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'#a3a3a3'</span>)</span>
<span id="cb3-450"><a href="#cb3-450" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> (<span class="st">"10,3"</span>))</span>
<span id="cb3-451"><a href="#cb3-451" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)<span class="op">;</span></span>
<span id="cb3-452"><a href="#cb3-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-453"><a href="#cb3-453" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (j<span class="op">&gt;</span><span class="dv">0</span>) {</span>
<span id="cb3-454"><a href="#cb3-454" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(eqrs[j])<span class="op">==</span><span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(eqrs[j<span class="op">-</span><span class="dv">1</span>])) {</span>
<span id="cb3-455"><a href="#cb3-455" aria-hidden="true" tabindex="-1"></a>          <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb3-456"><a href="#cb3-456" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-457"><a href="#cb3-457" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-458"><a href="#cb3-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-459"><a href="#cb3-459" aria-hidden="true" tabindex="-1"></a>      g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-460"><a href="#cb3-460" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"loss_runs"</span>)</span>
<span id="cb3-461"><a href="#cb3-461" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="st">"0.5em"</span>)</span>
<span id="cb3-462"><a href="#cb3-462" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-463"><a href="#cb3-463" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-464"><a href="#cb3-464" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> greyTextColor)</span>
<span id="cb3-465"><a href="#cb3-465" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">y</span>(eqrs[j]<span class="op">*</span><span class="dv">100</span><span class="op">/</span>(x<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>]))) <span class="co">// offset it from the edge of the rectangle</span></span>
<span id="cb3-466"><a href="#cb3-466" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(x<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>])<span class="op">-</span><span class="dv">60</span>) <span class="co">// offset it from the edge of the rectangle</span></span>
<span id="cb3-467"><a href="#cb3-467" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="kw">function</span>(){ </span>
<span id="cb3-468"><a href="#cb3-468" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> ((eqrs[<span class="dv">2</span>]<span class="op">&gt;</span>eqrs[<span class="dv">0</span>] <span class="op">&amp;&amp;</span> j<span class="op">==</span><span class="dv">0</span>) <span class="op">||</span> (eqrs[<span class="dv">2</span>]<span class="op">&lt;</span>eqrs[<span class="dv">0</span>] <span class="op">&amp;&amp;</span> j<span class="op">==</span><span class="dv">2</span>)) {</span>
<span id="cb3-469"><a href="#cb3-469" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"hanging"</span></span>
<span id="cb3-470"><a href="#cb3-470" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb3-471"><a href="#cb3-471" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> ((eqrs[<span class="dv">2</span>]<span class="op">&gt;</span>eqrs[<span class="dv">0</span>] <span class="op">&amp;&amp;</span> j<span class="op">==</span><span class="dv">2</span>) <span class="op">||</span> (eqrs[<span class="dv">2</span>]<span class="op">&lt;</span>eqrs[<span class="dv">0</span>] <span class="op">&amp;&amp;</span> j<span class="op">==</span><span class="dv">0</span>)) {</span>
<span id="cb3-472"><a href="#cb3-472" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"bottom"</span></span>
<span id="cb3-473"><a href="#cb3-473" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb3-474"><a href="#cb3-474" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (j<span class="op">==</span><span class="dv">1</span>) {</span>
<span id="cb3-475"><a href="#cb3-475" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"middle"</span></span>
<span id="cb3-476"><a href="#cb3-476" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb3-477"><a href="#cb3-477" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb3-478"><a href="#cb3-478" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".0f"</span>)(eqrs[j])<span class="op">+</span><span class="st">" runs"</span>)<span class="op">;</span></span>
<span id="cb3-479"><a href="#cb3-479" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-480"><a href="#cb3-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-481"><a href="#cb3-481" aria-hidden="true" tabindex="-1"></a>    hoverElementsGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb3-482"><a href="#cb3-482" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"win_sr_circle"</span>)</span>
<span id="cb3-483"><a href="#cb3-483" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-484"><a href="#cb3-484" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">AvSRWin</span>))</span>
<span id="cb3-485"><a href="#cb3-485" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">AvBallsWin</span>))</span>
<span id="cb3-486"><a href="#cb3-486" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-487"><a href="#cb3-487" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb3-488"><a href="#cb3-488" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">"#000000"</span>)</span>
<span id="cb3-489"><a href="#cb3-489" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb3-490"><a href="#cb3-490" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'opacity'</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb3-491"><a href="#cb3-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-492"><a href="#cb3-492" aria-hidden="true" tabindex="-1"></a>    hoverElementsGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">'line'</span>)</span>
<span id="cb3-493"><a href="#cb3-493" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'black'</span>)</span>
<span id="cb3-494"><a href="#cb3-494" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"loss_win"</span>)</span>
<span id="cb3-495"><a href="#cb3-495" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-496"><a href="#cb3-496" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'marker-end'</span><span class="op">,</span> <span class="st">'url(#arrow)'</span>)</span>
<span id="cb3-497"><a href="#cb3-497" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">AvSRLoss</span>))</span>
<span id="cb3-498"><a href="#cb3-498" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">AvBallsLoss</span>))</span>
<span id="cb3-499"><a href="#cb3-499" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">AvSRWin</span>))</span>
<span id="cb3-500"><a href="#cb3-500" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">AvBallsWin</span>))<span class="op">;</span></span>
<span id="cb3-501"><a href="#cb3-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-502"><a href="#cb3-502" aria-hidden="true" tabindex="-1"></a>    hoverElementsGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb3-503"><a href="#cb3-503" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"loss_sr_circle"</span>)</span>
<span id="cb3-504"><a href="#cb3-504" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-505"><a href="#cb3-505" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">AvSRLoss</span>))</span>
<span id="cb3-506"><a href="#cb3-506" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">AvBallsLoss</span>))</span>
<span id="cb3-507"><a href="#cb3-507" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#000000"</span>)</span>
<span id="cb3-508"><a href="#cb3-508" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb3-509"><a href="#cb3-509" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">"#ffffff"</span>)</span>
<span id="cb3-510"><a href="#cb3-510" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb3-511"><a href="#cb3-511" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'opacity'</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb3-512"><a href="#cb3-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-513"><a href="#cb3-513" aria-hidden="true" tabindex="-1"></a>    hoverElementsGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-514"><a href="#cb3-514" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"loss_label"</span>)</span>
<span id="cb3-515"><a href="#cb3-515" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-516"><a href="#cb3-516" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"-1em"</span>)</span>
<span id="cb3-517"><a href="#cb3-517" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> d<span class="op">.</span><span class="at">AvSRWin</span><span class="op">&gt;</span>d<span class="op">.</span><span class="at">AvSRLoss</span><span class="op">?</span> <span class="st">"1em"</span> <span class="op">:</span> <span class="st">"-1em"</span>)</span>
<span id="cb3-518"><a href="#cb3-518" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-519"><a href="#cb3-519" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-520"><a href="#cb3-520" aria-hidden="true" tabindex="-1"></a>      <span class="co">//.attr("font-weight", "bold")</span></span>
<span id="cb3-521"><a href="#cb3-521" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> greyTextColor)</span>
<span id="cb3-522"><a href="#cb3-522" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">AvBallsLoss</span>)) <span class="co">// offset it from the edge of the rectangle</span></span>
<span id="cb3-523"><a href="#cb3-523" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">AvSRLoss</span>)) <span class="co">// offset it from the edge of the rectangle</span></span>
<span id="cb3-524"><a href="#cb3-524" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-525"><a href="#cb3-525" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> d<span class="op">.</span><span class="at">AvSRWin</span><span class="op">&gt;</span>d<span class="op">.</span><span class="at">AvSRLoss</span><span class="op">?</span> <span class="st">"end"</span> <span class="op">:</span> <span class="st">"start"</span>)</span>
<span id="cb3-526"><a href="#cb3-526" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="st">"Loss"</span>)<span class="op">;</span></span>
<span id="cb3-527"><a href="#cb3-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-528"><a href="#cb3-528" aria-hidden="true" tabindex="-1"></a>    hoverElementsGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-529"><a href="#cb3-529" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"win_label"</span>)</span>
<span id="cb3-530"><a href="#cb3-530" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-531"><a href="#cb3-531" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"-1em"</span>)</span>
<span id="cb3-532"><a href="#cb3-532" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> d<span class="op">.</span><span class="at">AvSRWin</span><span class="op">&gt;</span>d<span class="op">.</span><span class="at">AvSRLoss</span><span class="op">?</span> <span class="st">"1em"</span> <span class="op">:</span> <span class="st">"-1em"</span>)</span>
<span id="cb3-533"><a href="#cb3-533" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-534"><a href="#cb3-534" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-535"><a href="#cb3-535" aria-hidden="true" tabindex="-1"></a>      <span class="co">// .attr("font-weight", "bold")</span></span>
<span id="cb3-536"><a href="#cb3-536" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> greyTextColor)</span>
<span id="cb3-537"><a href="#cb3-537" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">AvBallsWin</span>)) <span class="co">// offset it from the edge of the rectangle</span></span>
<span id="cb3-538"><a href="#cb3-538" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">AvSRWin</span>)) <span class="co">// offset it from the edge of the rectangle</span></span>
<span id="cb3-539"><a href="#cb3-539" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-540"><a href="#cb3-540" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> d<span class="op">.</span><span class="at">AvSRWin</span><span class="op">&gt;</span>d<span class="op">.</span><span class="at">AvSRLoss</span><span class="op">?</span> <span class="st">"end"</span> <span class="op">:</span> <span class="st">"start"</span>)</span>
<span id="cb3-541"><a href="#cb3-541" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="st">"Win"</span>)<span class="op">;</span></span>
<span id="cb3-542"><a href="#cb3-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-543"><a href="#cb3-543" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">.</span><span class="fu">select</span>(<span class="st">"#tp"</span>)</span>
<span id="cb3-544"><a href="#cb3-544" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb3-545"><a href="#cb3-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-546"><a href="#cb3-546" aria-hidden="true" tabindex="-1"></a>    hoverElementsGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-547"><a href="#cb3-547" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-548"><a href="#cb3-548" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"av_label"</span>)</span>
<span id="cb3-549"><a href="#cb3-549" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"-1.2em"</span>)</span>
<span id="cb3-550"><a href="#cb3-550" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="st">"-0.5em"</span>)</span>
<span id="cb3-551"><a href="#cb3-551" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-552"><a href="#cb3-552" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-553"><a href="#cb3-553" aria-hidden="true" tabindex="-1"></a>      <span class="co">// .attr("font-weight", "bold")</span></span>
<span id="cb3-554"><a href="#cb3-554" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> greyTextColor)</span>
<span id="cb3-555"><a href="#cb3-555" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">AvBalls</span>)) <span class="co">// offset it from the edge of the rectangle</span></span>
<span id="cb3-556"><a href="#cb3-556" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">AvSR</span>)) <span class="co">// offset it from the edge of the rectangle</span></span>
<span id="cb3-557"><a href="#cb3-557" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"bottom"</span>)</span>
<span id="cb3-558"><a href="#cb3-558" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="st">"All"</span>)<span class="op">;</span></span>
<span id="cb3-559"><a href="#cb3-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-560"><a href="#cb3-560" aria-hidden="true" tabindex="-1"></a>    <span class="co">// tooltipText.html(d.Name);</span></span>
<span id="cb3-561"><a href="#cb3-561" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-562"><a href="#cb3-562" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"0em"</span>)</span>
<span id="cb3-563"><a href="#cb3-563" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-564"><a href="#cb3-564" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">20</span>)</span>
<span id="cb3-565"><a href="#cb3-565" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb3-566"><a href="#cb3-566" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> greyTextColor)</span>
<span id="cb3-567"><a href="#cb3-567" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb3-568"><a href="#cb3-568" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb3-569"><a href="#cb3-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-570"><a href="#cb3-570" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> diff_sr <span class="op">=</span> d<span class="op">.</span><span class="at">AvSRWin</span> <span class="op">-</span> d<span class="op">.</span><span class="at">AvSRLoss</span></span>
<span id="cb3-571"><a href="#cb3-571" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-572"><a href="#cb3-572" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"1.1em"</span>) <span class="co">// you can vary how far apart it shows up</span></span>
<span id="cb3-573"><a href="#cb3-573" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-574"><a href="#cb3-574" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">18</span>)</span>
<span id="cb3-575"><a href="#cb3-575" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb3-576"><a href="#cb3-576" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="st">"SR: "</span><span class="op">+</span>d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".1f"</span>)(d<span class="op">.</span><span class="at">AvSR</span>))</span>
<span id="cb3-577"><a href="#cb3-577" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> greyTextColor)</span>
<span id="cb3-578"><a href="#cb3-578" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"tspan"</span>)</span>
<span id="cb3-579"><a href="#cb3-579" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-580"><a href="#cb3-580" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-581"><a href="#cb3-581" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> greyTextColor)</span>
<span id="cb3-582"><a href="#cb3-582" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb3-583"><a href="#cb3-583" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(diff_sr<span class="op">&gt;</span><span class="dv">0</span><span class="op">?</span> <span class="st">" +"</span><span class="op">+</span>d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".0f"</span>)(diff_sr)<span class="op">:</span> <span class="st">" "</span><span class="op">+</span>d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".0f"</span>)(diff_sr))</span>
<span id="cb3-584"><a href="#cb3-584" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> diff_sr<span class="op">&gt;</span><span class="dv">0</span><span class="op">?</span> <span class="st">"green"</span><span class="op">:</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb3-585"><a href="#cb3-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-586"><a href="#cb3-586" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> diff_balls <span class="op">=</span> d<span class="op">.</span><span class="at">AvBallsWin</span> <span class="op">-</span> d<span class="op">.</span><span class="at">AvBallsLoss</span></span>
<span id="cb3-587"><a href="#cb3-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-588"><a href="#cb3-588" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-589"><a href="#cb3-589" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"2.1em"</span>) <span class="co">// you can vary how far apart it shows up</span></span>
<span id="cb3-590"><a href="#cb3-590" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-591"><a href="#cb3-591" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">18</span>)</span>
<span id="cb3-592"><a href="#cb3-592" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> greyTextColor)</span>
<span id="cb3-593"><a href="#cb3-593" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb3-594"><a href="#cb3-594" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="st">"Balls: "</span><span class="op">+</span>d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".0f"</span>)(d<span class="op">.</span><span class="at">AvBalls</span>))</span>
<span id="cb3-595"><a href="#cb3-595" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"tspan"</span>)</span>
<span id="cb3-596"><a href="#cb3-596" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-597"><a href="#cb3-597" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-598"><a href="#cb3-598" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> greyTextColor)</span>
<span id="cb3-599"><a href="#cb3-599" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb3-600"><a href="#cb3-600" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(diff_balls<span class="op">&gt;</span><span class="dv">0</span><span class="op">?</span> <span class="st">" +"</span><span class="op">+</span>d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".0f"</span>)(diff_balls)<span class="op">:</span> <span class="st">" "</span><span class="op">+</span>d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".0f"</span>)(diff_balls))</span>
<span id="cb3-601"><a href="#cb3-601" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> diff_balls<span class="op">&gt;</span><span class="dv">0</span><span class="op">?</span> <span class="st">"green"</span><span class="op">:</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb3-602"><a href="#cb3-602" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-603"><a href="#cb3-603" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)</span>
<span id="cb3-604"><a href="#cb3-604" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> baseRadius <span class="op">*</span> <span class="dv">3</span>)</span>
<span id="cb3-605"><a href="#cb3-605" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'opacity'</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb3-606"><a href="#cb3-606" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">raise</span>()</span>
<span id="cb3-607"><a href="#cb3-607" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="fu">battingPositionColor</span>(d<span class="op">.</span><span class="at">BattingPosition</span>))<span class="op">;</span></span>
<span id="cb3-608"><a href="#cb3-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-609"><a href="#cb3-609" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> xPos <span class="op">=</span> <span class="fl">0.7</span><span class="op">*</span><span class="fu">x</span>(x<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>])</span>
<span id="cb3-610"><a href="#cb3-610" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> yPos <span class="op">=</span> <span class="fl">0.1</span><span class="op">*</span><span class="fu">y</span>(y<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">0</span>])</span>
<span id="cb3-611"><a href="#cb3-611" aria-hidden="true" tabindex="-1"></a>    tooltip</span>
<span id="cb3-612"><a href="#cb3-612" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>xPos<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span>yPos<span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb3-613"><a href="#cb3-613" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"visible"</span>)<span class="op">;</span></span>
<span id="cb3-614"><a href="#cb3-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-615"><a href="#cb3-615" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Add a side axis group for innings_points</span></span>
<span id="cb3-616"><a href="#cb3-616" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Linear x-scale, domain and range set</span></span>
<span id="cb3-617"><a href="#cb3-617" aria-hidden="true" tabindex="-1"></a>    <span class="co">// xSide.domain(d3.extent(d.SR)).nice();</span></span>
<span id="cb3-618"><a href="#cb3-618" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ySide.domain(d3.extent(d.Balls)).nice();</span></span>
<span id="cb3-619"><a href="#cb3-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-620"><a href="#cb3-620" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Making side axis group visible</span></span>
<span id="cb3-621"><a href="#cb3-621" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupTop<span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"visible"</span>)<span class="op">;</span></span>
<span id="cb3-622"><a href="#cb3-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-623"><a href="#cb3-623" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Attach axes to the main group</span></span>
<span id="cb3-624"><a href="#cb3-624" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupTop<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">call</span>(xAxisSide<span class="op">,</span> xSide)<span class="op">;</span></span>
<span id="cb3-625"><a href="#cb3-625" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupTop<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">call</span>(yAxisSide<span class="op">,</span> ySide)<span class="op">;</span></span>
<span id="cb3-626"><a href="#cb3-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-627"><a href="#cb3-627" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupTop<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)</span>
<span id="cb3-628"><a href="#cb3-628" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)<span class="op">;</span></span>
<span id="cb3-629"><a href="#cb3-629" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-630"><a href="#cb3-630" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupTop<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-631"><a href="#cb3-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-632"><a href="#cb3-632" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupBottom<span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"visible"</span>)<span class="op">;</span></span>
<span id="cb3-633"><a href="#cb3-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-634"><a href="#cb3-634" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Attach axes to the main group</span></span>
<span id="cb3-635"><a href="#cb3-635" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupBottom<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">call</span>(xAxisSide<span class="op">,</span> xSide)<span class="op">;</span></span>
<span id="cb3-636"><a href="#cb3-636" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupBottom<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">call</span>(yAxisSide<span class="op">,</span> ySide)<span class="op">;</span></span>
<span id="cb3-637"><a href="#cb3-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-638"><a href="#cb3-638" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupBottom<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)</span>
<span id="cb3-639"><a href="#cb3-639" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)<span class="op">;</span></span>
<span id="cb3-640"><a href="#cb3-640" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-641"><a href="#cb3-641" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupBottom<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-642"><a href="#cb3-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-643"><a href="#cb3-643" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupBottom<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-644"><a href="#cb3-644" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-645"><a href="#cb3-645" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-646"><a href="#cb3-646" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb3-647"><a href="#cb3-647" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb3-648"><a href="#cb3-648" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb3-649"><a href="#cb3-649" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="dv">100</span>)</span>
<span id="cb3-650"><a href="#cb3-650" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb3-651"><a href="#cb3-651" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb3-652"><a href="#cb3-652" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="st">"Wins"</span>)<span class="op">;</span></span>
<span id="cb3-653"><a href="#cb3-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-654"><a href="#cb3-654" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupTop<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-655"><a href="#cb3-655" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-656"><a href="#cb3-656" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-657"><a href="#cb3-657" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb3-658"><a href="#cb3-658" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb3-659"><a href="#cb3-659" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb3-660"><a href="#cb3-660" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="dv">100</span>)</span>
<span id="cb3-661"><a href="#cb3-661" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb3-662"><a href="#cb3-662" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb3-663"><a href="#cb3-663" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="st">"Losses"</span>)<span class="op">;</span></span>
<span id="cb3-664"><a href="#cb3-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-665"><a href="#cb3-665" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupBottom<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-666"><a href="#cb3-666" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-667"><a href="#cb3-667" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-668"><a href="#cb3-668" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb3-669"><a href="#cb3-669" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="dv">110</span>)</span>
<span id="cb3-670"><a href="#cb3-670" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="op">-</span><span class="dv">3</span>)</span>
<span id="cb3-671"><a href="#cb3-671" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb3-672"><a href="#cb3-672" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(minSR)<span class="op">;</span></span>
<span id="cb3-673"><a href="#cb3-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-674"><a href="#cb3-674" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupBottom<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-675"><a href="#cb3-675" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-676"><a href="#cb3-676" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-677"><a href="#cb3-677" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb3-678"><a href="#cb3-678" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="dv">110</span>)</span>
<span id="cb3-679"><a href="#cb3-679" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="dv">90</span>)</span>
<span id="cb3-680"><a href="#cb3-680" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb3-681"><a href="#cb3-681" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(maxSR)<span class="op">;</span></span>
<span id="cb3-682"><a href="#cb3-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-683"><a href="#cb3-683" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupBottom<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-684"><a href="#cb3-684" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-685"><a href="#cb3-685" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-686"><a href="#cb3-686" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb3-687"><a href="#cb3-687" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-688"><a href="#cb3-688" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="op">-</span><span class="dv">10</span>)</span>
<span id="cb3-689"><a href="#cb3-689" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-690"><a href="#cb3-690" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb3-691"><a href="#cb3-691" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(maxBalls)<span class="op">;</span></span>
<span id="cb3-692"><a href="#cb3-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-693"><a href="#cb3-693" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupBottom<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-694"><a href="#cb3-694" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-695"><a href="#cb3-695" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-696"><a href="#cb3-696" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb3-697"><a href="#cb3-697" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="dv">100</span>)</span>
<span id="cb3-698"><a href="#cb3-698" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="op">-</span><span class="dv">10</span>)</span>
<span id="cb3-699"><a href="#cb3-699" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-700"><a href="#cb3-700" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb3-701"><a href="#cb3-701" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(minBalls)<span class="op">;</span></span>
<span id="cb3-702"><a href="#cb3-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-703"><a href="#cb3-703" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(d<span class="op">.</span><span class="at">SR</span><span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(xx<span class="op">,</span> i) {</span>
<span id="cb3-704"><a href="#cb3-704" aria-hidden="true" tabindex="-1"></a>      sideCirclesGroupTop<span class="op">.</span><span class="fu">append</span>(<span class="st">'circle'</span>)</span>
<span id="cb3-705"><a href="#cb3-705" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"innings_points"</span>)</span>
<span id="cb3-706"><a href="#cb3-706" aria-hidden="true" tabindex="-1"></a>        <span class="co">// .attr('clip-path', 'url(#border)')</span></span>
<span id="cb3-707"><a href="#cb3-707" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-708"><a href="#cb3-708" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="fu">xSide</span>(d<span class="op">.</span><span class="at">SR</span>[xx]))</span>
<span id="cb3-709"><a href="#cb3-709" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="fu">ySide</span>(d<span class="op">.</span><span class="at">Balls</span>[xx]))</span>
<span id="cb3-710"><a href="#cb3-710" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb3-711"><a href="#cb3-711" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.5</span>)</span>
<span id="cb3-712"><a href="#cb3-712" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#b3b3b3"</span>)</span>
<span id="cb3-713"><a href="#cb3-713" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb3-714"><a href="#cb3-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-715"><a href="#cb3-715" aria-hidden="true" tabindex="-1"></a>      sideCirclesGroupBottom<span class="op">.</span><span class="fu">append</span>(<span class="st">'circle'</span>)</span>
<span id="cb3-716"><a href="#cb3-716" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"innings_points"</span>)</span>
<span id="cb3-717"><a href="#cb3-717" aria-hidden="true" tabindex="-1"></a>        <span class="co">// .attr('clip-path', 'url(#border)')</span></span>
<span id="cb3-718"><a href="#cb3-718" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-719"><a href="#cb3-719" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="fu">xSide</span>(d<span class="op">.</span><span class="at">SR</span>[xx]))</span>
<span id="cb3-720"><a href="#cb3-720" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="fu">ySide</span>(d<span class="op">.</span><span class="at">Balls</span>[xx]))</span>
<span id="cb3-721"><a href="#cb3-721" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb3-722"><a href="#cb3-722" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.5</span>)</span>
<span id="cb3-723"><a href="#cb3-723" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#b3b3b3"</span>)</span>
<span id="cb3-724"><a href="#cb3-724" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb3-725"><a href="#cb3-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-726"><a href="#cb3-726" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-727"><a href="#cb3-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-728"><a href="#cb3-728" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(d<span class="op">.</span><span class="at">SR</span><span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(xx<span class="op">,</span> i) {</span>
<span id="cb3-729"><a href="#cb3-729" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (d<span class="op">.</span><span class="at">Won</span>[xx]<span class="op">==</span><span class="st">"No"</span>) {</span>
<span id="cb3-730"><a href="#cb3-730" aria-hidden="true" tabindex="-1"></a>        sideCirclesGroupTop<span class="op">.</span><span class="fu">append</span>(<span class="st">'circle'</span>)</span>
<span id="cb3-731"><a href="#cb3-731" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"innings_points"</span>)</span>
<span id="cb3-732"><a href="#cb3-732" aria-hidden="true" tabindex="-1"></a>          <span class="co">// .attr('clip-path', 'url(#border)')</span></span>
<span id="cb3-733"><a href="#cb3-733" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-734"><a href="#cb3-734" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="fu">xSide</span>(d<span class="op">.</span><span class="at">SR</span>[xx]))</span>
<span id="cb3-735"><a href="#cb3-735" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="fu">ySide</span>(d<span class="op">.</span><span class="at">Balls</span>[xx]))</span>
<span id="cb3-736"><a href="#cb3-736" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb3-737"><a href="#cb3-737" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#FF6B6C"</span>)</span>
<span id="cb3-738"><a href="#cb3-738" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#000000"</span>)</span>
<span id="cb3-739"><a href="#cb3-739" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb3-740"><a href="#cb3-740" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-741"><a href="#cb3-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-742"><a href="#cb3-742" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (d<span class="op">.</span><span class="at">Won</span>[xx]<span class="op">==</span><span class="st">"Yes"</span>) {</span>
<span id="cb3-743"><a href="#cb3-743" aria-hidden="true" tabindex="-1"></a>        sideCirclesGroupBottom<span class="op">.</span><span class="fu">append</span>(<span class="st">'circle'</span>)</span>
<span id="cb3-744"><a href="#cb3-744" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"innings_points"</span>)</span>
<span id="cb3-745"><a href="#cb3-745" aria-hidden="true" tabindex="-1"></a>          <span class="co">// .attr('clip-path', 'url(#border)')</span></span>
<span id="cb3-746"><a href="#cb3-746" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-747"><a href="#cb3-747" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="fu">xSide</span>(d<span class="op">.</span><span class="at">SR</span>[xx]))</span>
<span id="cb3-748"><a href="#cb3-748" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="fu">ySide</span>(d<span class="op">.</span><span class="at">Balls</span>[xx]))</span>
<span id="cb3-749"><a href="#cb3-749" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb3-750"><a href="#cb3-750" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#B4BA39"</span>)</span>
<span id="cb3-751"><a href="#cb3-751" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#000000"</span>)</span>
<span id="cb3-752"><a href="#cb3-752" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb3-753"><a href="#cb3-753" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-754"><a href="#cb3-754" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-755"><a href="#cb3-755" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-756"><a href="#cb3-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-757"><a href="#cb3-757" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Function to handle mouse leaving</span></span>
<span id="cb3-758"><a href="#cb3-758" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">mouseLeave</span>(<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb3-759"><a href="#cb3-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-760"><a href="#cb3-760" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupTop<span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)</span>
<span id="cb3-761"><a href="#cb3-761" aria-hidden="true" tabindex="-1"></a>    sideAxisGroupBottom<span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)</span>
<span id="cb3-762"><a href="#cb3-762" aria-hidden="true" tabindex="-1"></a>    sideCirclesGroupTop<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".innings_points"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-763"><a href="#cb3-763" aria-hidden="true" tabindex="-1"></a>    sideCirclesGroupBottom<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".innings_points"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-764"><a href="#cb3-764" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">select</span>(<span class="st">"#loss_win"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-765"><a href="#cb3-765" aria-hidden="true" tabindex="-1"></a>    hoverElementsGroup<span class="op">.</span><span class="fu">select</span>(<span class="st">"#loss_sr_circle"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-766"><a href="#cb3-766" aria-hidden="true" tabindex="-1"></a>    hoverElementsGroup<span class="op">.</span><span class="fu">select</span>(<span class="st">"#win_sr_circle"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-767"><a href="#cb3-767" aria-hidden="true" tabindex="-1"></a>    hoverElementsGroup<span class="op">.</span><span class="fu">select</span>(<span class="st">"#loss_label"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-768"><a href="#cb3-768" aria-hidden="true" tabindex="-1"></a>    hoverElementsGroup<span class="op">.</span><span class="fu">select</span>(<span class="st">"#win_label"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-769"><a href="#cb3-769" aria-hidden="true" tabindex="-1"></a>    hoverElementsGroup<span class="op">.</span><span class="fu">select</span>(<span class="st">"#av_label"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-770"><a href="#cb3-770" aria-hidden="true" tabindex="-1"></a>    hoverElementsGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hover_eqr_lines"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-771"><a href="#cb3-771" aria-hidden="true" tabindex="-1"></a>    hoverElementsGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".innings_points"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-772"><a href="#cb3-772" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".highlighted_labels"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-773"><a href="#cb3-773" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".loss_runs"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-774"><a href="#cb3-774" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".main_eqr_lines"</span>)</span>
<span id="cb3-775"><a href="#cb3-775" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"visible"</span>)<span class="op">;</span></span>
<span id="cb3-776"><a href="#cb3-776" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".main_eqr_run_labels"</span>)</span>
<span id="cb3-777"><a href="#cb3-777" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"visible"</span>)<span class="op">;</span></span>
<span id="cb3-778"><a href="#cb3-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-779"><a href="#cb3-779" aria-hidden="true" tabindex="-1"></a>    baseCirclesGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'circle'</span>)</span>
<span id="cb3-780"><a href="#cb3-780" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> d <span class="kw">=&gt;</span> highlighted<span class="op">.</span><span class="fu">get</span>(d)<span class="op">?</span> <span class="st">"none"</span> <span class="op">:</span> <span class="st">"black"</span>)</span>
<span id="cb3-781"><a href="#cb3-781" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> d <span class="kw">=&gt;</span> highlighted<span class="op">.</span><span class="fu">get</span>(d)<span class="op">?</span> <span class="fl">0.5</span> <span class="op">:</span> <span class="dv">1</span>)</span>
<span id="cb3-782"><a href="#cb3-782" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span>  <span class="fu">battingPositionColor</span>(d<span class="op">.</span><span class="at">BattingPosition</span>))<span class="op">;</span></span>
<span id="cb3-783"><a href="#cb3-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-784"><a href="#cb3-784" aria-hidden="true" tabindex="-1"></a>    baseCirclesGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'circle'</span>)  <span class="co">//here's how you get all the nodes</span></span>
<span id="cb3-785"><a href="#cb3-785" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">each</span>(<span class="kw">function</span>(d) {</span>
<span id="cb3-786"><a href="#cb3-786" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="op">!</span>highlighted<span class="op">.</span><span class="fu">get</span>(d)) {</span>
<span id="cb3-787"><a href="#cb3-787" aria-hidden="true" tabindex="-1"></a>          g<span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb3-788"><a href="#cb3-788" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'highlighted_labels'</span>)</span>
<span id="cb3-789"><a href="#cb3-789" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">'fill'</span><span class="op">,</span> greyTextColor)</span>
<span id="cb3-790"><a href="#cb3-790" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-791"><a href="#cb3-791" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-792"><a href="#cb3-792" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb3-793"><a href="#cb3-793" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"alphabetical"</span>)</span>
<span id="cb3-794"><a href="#cb3-794" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"start"</span>)</span>
<span id="cb3-795"><a href="#cb3-795" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">AvSR</span>)<span class="op">+</span>baseRadius<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb3-796"><a href="#cb3-796" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">AvBalls</span>)<span class="op">-</span>baseRadius<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb3-797"><a href="#cb3-797" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(d<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb3-798"><a href="#cb3-798" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-799"><a href="#cb3-799" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb3-800"><a href="#cb3-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-801"><a href="#cb3-801" aria-hidden="true" tabindex="-1"></a>    <span class="co">// reset the size of the circle</span></span>
<span id="cb3-802"><a href="#cb3-802" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)</span>
<span id="cb3-803"><a href="#cb3-803" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> d <span class="kw">=&gt;</span> highlighted<span class="op">.</span><span class="fu">get</span>(d)<span class="op">?</span> baseRadius <span class="op">:</span> baseRadius <span class="op">*</span> <span class="fl">1.5</span>)</span>
<span id="cb3-804"><a href="#cb3-804" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> d <span class="kw">=&gt;</span> highlighted<span class="op">.</span><span class="fu">get</span>(d)<span class="op">?</span> <span class="st">"none"</span> <span class="op">:</span> <span class="st">"black"</span>)</span>
<span id="cb3-805"><a href="#cb3-805" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> d <span class="kw">=&gt;</span> highlighted<span class="op">.</span><span class="fu">get</span>(d)<span class="op">?</span> <span class="fl">0.5</span> <span class="op">:</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb3-806"><a href="#cb3-806" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-807"><a href="#cb3-807" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-808"><a href="#cb3-808" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-809"><a href="#cb3-809" aria-hidden="true" tabindex="-1"></a>    <span class="co">// make the tooltip invisible</span></span>
<span id="cb3-810"><a href="#cb3-810" aria-hidden="true" tabindex="-1"></a>    tooltip</span>
<span id="cb3-811"><a href="#cb3-811" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)<span class="op">;</span></span>
<span id="cb3-812"><a href="#cb3-812" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-813"><a href="#cb3-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-814"><a href="#cb3-814" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Function to handle mouse clicks</span></span>
<span id="cb3-815"><a href="#cb3-815" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">clicked</span>(<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb3-816"><a href="#cb3-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-817"><a href="#cb3-817" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> isHighlighted <span class="op">=</span> highlighted<span class="op">.</span><span class="fu">get</span>(d)<span class="op">;</span></span>
<span id="cb3-818"><a href="#cb3-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-819"><a href="#cb3-819" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)</span>
<span id="cb3-820"><a href="#cb3-820" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">raise</span>()</span>
<span id="cb3-821"><a href="#cb3-821" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> d <span class="kw">=&gt;</span> isHighlighted<span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"none"</span>)</span>
<span id="cb3-822"><a href="#cb3-822" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> d <span class="kw">=&gt;</span> isHighlighted<span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="fl">0.75</span>)<span class="op">;</span></span>
<span id="cb3-823"><a href="#cb3-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-824"><a href="#cb3-824" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)</span>
<span id="cb3-825"><a href="#cb3-825" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-826"><a href="#cb3-826" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-827"><a href="#cb3-827" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">22</span>)</span>
<span id="cb3-828"><a href="#cb3-828" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb3-829"><a href="#cb3-829" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb3-830"><a href="#cb3-830" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(d<span class="op">.</span><span class="at">Wins</span>)<span class="op">;</span></span>
<span id="cb3-831"><a href="#cb3-831" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-832"><a href="#cb3-832" aria-hidden="true" tabindex="-1"></a>    highlighted<span class="op">.</span><span class="fu">set</span>(d<span class="op">,</span> <span class="op">!</span>isHighlighted)<span class="op">;</span></span>
<span id="cb3-833"><a href="#cb3-833" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-834"><a href="#cb3-834" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-835"><a href="#cb3-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-836"><a href="#cb3-836" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Draw legend</span></span>
<span id="cb3-837"><a href="#cb3-837" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xShift <span class="op">=</span> visWidth <span class="op">+</span> margin<span class="op">.</span><span class="at">left</span></span>
<span id="cb3-838"><a href="#cb3-838" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yShift <span class="op">=</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> <span class="dv">10</span></span>
<span id="cb3-839"><a href="#cb3-839" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legend <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb3-840"><a href="#cb3-840" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'transform'</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>xShift<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>yShift<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-841"><a href="#cb3-841" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-842"><a href="#cb3-842" aria-hidden="true" tabindex="-1"></a>  legend<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-843"><a href="#cb3-843" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Select type:"</span>)</span>
<span id="cb3-844"><a href="#cb3-844" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-845"><a href="#cb3-845" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'dominant-baseline'</span><span class="op">,</span> <span class="st">'middle'</span>)</span>
<span id="cb3-846"><a href="#cb3-846" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb3-847"><a href="#cb3-847" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'text-anchor'</span><span class="op">,</span> <span class="st">'start'</span>)</span>
<span id="cb3-848"><a href="#cb3-848" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'font-family'</span><span class="op">,</span> <span class="st">'roboto'</span>)</span>
<span id="cb3-849"><a href="#cb3-849" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb3-850"><a href="#cb3-850" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> <span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb3-851"><a href="#cb3-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-852"><a href="#cb3-852" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> rows <span class="op">=</span> legend<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'g'</span>)</span>
<span id="cb3-853"><a href="#cb3-853" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(BattingPositions)</span>
<span id="cb3-854"><a href="#cb3-854" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'g'</span>)</span>
<span id="cb3-855"><a href="#cb3-855" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'transform'</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="vs">`translate(20, </span><span class="sc">${</span>(i<span class="op">+</span><span class="dv">1</span>) <span class="op">*</span> <span class="dv">20</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-856"><a href="#cb3-856" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-857"><a href="#cb3-857" aria-hidden="true" tabindex="-1"></a>  rows<span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb3-858"><a href="#cb3-858" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-859"><a href="#cb3-859" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-860"><a href="#cb3-860" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb3-861"><a href="#cb3-861" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">battingPositionColor</span>(d))</span>
<span id="cb3-862"><a href="#cb3-862" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">battingPositionColor</span>(d))</span>
<span id="cb3-863"><a href="#cb3-863" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">'click'</span><span class="op">,</span> onclick)<span class="op">;</span></span>
<span id="cb3-864"><a href="#cb3-864" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-865"><a href="#cb3-865" aria-hidden="true" tabindex="-1"></a>  rows<span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb3-866"><a href="#cb3-866" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-867"><a href="#cb3-867" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> <span class="dv">20</span>)</span>
<span id="cb3-868"><a href="#cb3-868" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> <span class="fl">7.5</span>)</span>
<span id="cb3-869"><a href="#cb3-869" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb3-870"><a href="#cb3-870" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'font-family'</span><span class="op">,</span> <span class="st">'roboto'</span>)</span>
<span id="cb3-871"><a href="#cb3-871" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'dominant-baseline'</span><span class="op">,</span> <span class="st">'middle'</span>)</span>
<span id="cb3-872"><a href="#cb3-872" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)</span>
<span id="cb3-873"><a href="#cb3-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-874"><a href="#cb3-874" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Track which batting-positions are selected</span></span>
<span id="cb3-875"><a href="#cb3-875" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> selected <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>(BattingPositions<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> [d<span class="op">,</span> <span class="kw">true</span>]))<span class="op">;</span></span>
<span id="cb3-876"><a href="#cb3-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-877"><a href="#cb3-877" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">onclick</span>(<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb3-878"><a href="#cb3-878" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> isSelected <span class="op">=</span> selected<span class="op">.</span><span class="fu">get</span>(d)<span class="op">;</span></span>
<span id="cb3-879"><a href="#cb3-879" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-880"><a href="#cb3-880" aria-hidden="true" tabindex="-1"></a>    <span class="co">// select the square and toggle it</span></span>
<span id="cb3-881"><a href="#cb3-881" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> square <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)<span class="op">;</span></span>
<span id="cb3-882"><a href="#cb3-882" aria-hidden="true" tabindex="-1"></a>    square<span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> d <span class="kw">=&gt;</span> isSelected <span class="op">?</span> <span class="st">'white'</span> <span class="op">:</span> <span class="fu">battingPositionColor</span>(d))<span class="op">;</span></span>
<span id="cb3-883"><a href="#cb3-883" aria-hidden="true" tabindex="-1"></a>    selected<span class="op">.</span><span class="fu">set</span>(d<span class="op">,</span> <span class="op">!</span>isSelected)<span class="op">;</span></span>
<span id="cb3-884"><a href="#cb3-884" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-885"><a href="#cb3-885" aria-hidden="true" tabindex="-1"></a>    <span class="co">// redraw the points</span></span>
<span id="cb3-886"><a href="#cb3-886" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">select</span>(<span class="st">"#mean_balls"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-887"><a href="#cb3-887" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">select</span>(<span class="st">"#mean_sr"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-888"><a href="#cb3-888" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".highlighted_labels"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-889"><a href="#cb3-889" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drawPoints</span>(data<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> selected<span class="op">.</span><span class="fu">get</span>(d<span class="op">.</span><span class="at">BattingPosition</span>)))<span class="op">;</span></span>
<span id="cb3-890"><a href="#cb3-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-891"><a href="#cb3-891" aria-hidden="true" tabindex="-1"></a>    baseCirclesGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'circle'</span>)  <span class="co">//here's how you get all the nodes</span></span>
<span id="cb3-892"><a href="#cb3-892" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">each</span>(<span class="kw">function</span>(d) {</span>
<span id="cb3-893"><a href="#cb3-893" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="op">!</span>highlighted<span class="op">.</span><span class="fu">get</span>(d)) {</span>
<span id="cb3-894"><a href="#cb3-894" aria-hidden="true" tabindex="-1"></a>          g<span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb3-895"><a href="#cb3-895" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'highlighted_labels'</span>)</span>
<span id="cb3-896"><a href="#cb3-896" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">style</span>(<span class="st">'fill'</span><span class="op">,</span> greyTextColor)</span>
<span id="cb3-897"><a href="#cb3-897" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb3-898"><a href="#cb3-898" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb3-899"><a href="#cb3-899" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb3-900"><a href="#cb3-900" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"alphabetical"</span>)</span>
<span id="cb3-901"><a href="#cb3-901" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"start"</span>)</span>
<span id="cb3-902"><a href="#cb3-902" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">AvSR</span>)<span class="op">+</span>baseRadius<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb3-903"><a href="#cb3-903" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">AvBalls</span>)<span class="op">-</span>baseRadius<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb3-904"><a href="#cb3-904" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">text</span>(d<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb3-905"><a href="#cb3-905" aria-hidden="true" tabindex="-1"></a>            <span class="co">//.call(drag);</span></span>
<span id="cb3-906"><a href="#cb3-906" aria-hidden="true" tabindex="-1"></a>            <span class="co">//.call(d3.drag().on("start", dragstarted))</span></span>
<span id="cb3-907"><a href="#cb3-907" aria-hidden="true" tabindex="-1"></a>            <span class="co">//.call(d3.drag().on("drag", dragged))</span></span>
<span id="cb3-908"><a href="#cb3-908" aria-hidden="true" tabindex="-1"></a>            <span class="co">//.call(d3.drag().on("end", dragended));</span></span>
<span id="cb3-909"><a href="#cb3-909" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-910"><a href="#cb3-910" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb3-911"><a href="#cb3-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-912"><a href="#cb3-912" aria-hidden="true" tabindex="-1"></a>    baseCirclesGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'circle'</span>)</span>
<span id="cb3-913"><a href="#cb3-913" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> d <span class="kw">=&gt;</span> highlighted<span class="op">.</span><span class="fu">get</span>(d)<span class="op">?</span> <span class="st">"none"</span> <span class="op">:</span> <span class="st">"black"</span>)</span>
<span id="cb3-914"><a href="#cb3-914" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> d <span class="kw">=&gt;</span> highlighted<span class="op">.</span><span class="fu">get</span>(d)<span class="op">?</span> baseRadius <span class="op">:</span> baseRadius <span class="op">*</span> <span class="fl">1.5</span>)</span>
<span id="cb3-915"><a href="#cb3-915" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> d <span class="kw">=&gt;</span> highlighted<span class="op">.</span><span class="fu">get</span>(d)<span class="op">?</span> <span class="fl">0.25</span> <span class="op">:</span> <span class="dv">1</span>)</span>
<span id="cb3-916"><a href="#cb3-916" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span>  <span class="fu">battingPositionColor</span>(d<span class="op">.</span><span class="at">BattingPosition</span>))<span class="op">;</span></span>
<span id="cb3-917"><a href="#cb3-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-918"><a href="#cb3-918" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-919"><a href="#cb3-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-920"><a href="#cb3-920" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb3-921"><a href="#cb3-921" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p>Below is an interactive plot of how different batters did (strike-rates and balls faced) in their IPL innings when their team won and lost, compared to the overall distribution of how batters do in general.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="929" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 928;"><span id="cb4-929"><a href="#cb4-929" aria-hidden="true" tabindex="-1"></a><span class="co">// ["V Kohli", "AB de Villiers", "MS Dhoni"]</span></span>
<span id="cb4-930"><a href="#cb4-930" aria-hidden="true" tabindex="-1"></a>viewof chosen_batter <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(all_batter_names<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="st">'V Kohli'</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'Choose batter'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="column-page-right">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="935" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 934;"><span id="cb5-935"><a href="#cb5-935" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb5-936"><a href="#cb5-936" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Setting up the overall chart dimensions</span></span>
<span id="cb5-937"><a href="#cb5-937" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> ({<span class="dt">top</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">65</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">60</span>})</span>
<span id="cb5-938"><a href="#cb5-938" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> visWidth <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb5-939"><a href="#cb5-939" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> visHeight <span class="op">=</span> <span class="dv">400</span></span>
<span id="cb5-940"><a href="#cb5-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-941"><a href="#cb5-941" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> textColor <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">"p"</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"color"</span>)</span>
<span id="cb5-942"><a href="#cb5-942" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> greyTextColor <span class="op">=</span> <span class="st">"#212529"</span></span>
<span id="cb5-943"><a href="#cb5-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-944"><a href="#cb5-944" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> all_SR <span class="op">=</span> []</span>
<span id="cb5-945"><a href="#cb5-945" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> all_balls <span class="op">=</span> []</span>
<span id="cb5-946"><a href="#cb5-946" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">range</span>(data<span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(xx<span class="op">,</span> i) {</span>
<span id="cb5-947"><a href="#cb5-947" aria-hidden="true" tabindex="-1"></a>    all_SR <span class="op">=</span> d3<span class="op">.</span><span class="fu">merge</span>([all_SR<span class="op">,</span> data[xx]<span class="op">.</span><span class="at">SR</span>])</span>
<span id="cb5-948"><a href="#cb5-948" aria-hidden="true" tabindex="-1"></a>    all_balls <span class="op">=</span> d3<span class="op">.</span><span class="fu">merge</span>([all_balls<span class="op">,</span> data[xx]<span class="op">.</span><span class="at">Balls</span>]) </span>
<span id="cb5-949"><a href="#cb5-949" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb5-950"><a href="#cb5-950" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> minSR <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(all_SR)</span>
<span id="cb5-951"><a href="#cb5-951" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> maxSR <span class="op">=</span> d3<span class="op">.</span><span class="fu">quantile</span>(all_SR<span class="op">,</span> <span class="fl">0.99</span>)</span>
<span id="cb5-952"><a href="#cb5-952" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> minBalls <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(all_balls)</span>
<span id="cb5-953"><a href="#cb5-953" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> maxBalls <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(all_balls)</span>
<span id="cb5-954"><a href="#cb5-954" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dx <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb5-955"><a href="#cb5-955" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dy <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb5-956"><a href="#cb5-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-957"><a href="#cb5-957" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xScale <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb5-958"><a href="#cb5-958" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">domain</span>([minSR<span class="op">-</span>dx<span class="op">/</span><span class="dv">2</span><span class="op">,</span> maxSR<span class="op">+</span>dx<span class="op">/</span><span class="dv">2</span>])</span>
<span id="cb5-959"><a href="#cb5-959" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> visWidth])<span class="op">;</span></span>
<span id="cb5-960"><a href="#cb5-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-961"><a href="#cb5-961" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Linear y-scale, domain and range set</span></span>
<span id="cb5-962"><a href="#cb5-962" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yScale <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb5-963"><a href="#cb5-963" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">domain</span>([minBalls<span class="op">-</span>dy<span class="op">/</span><span class="dv">2</span><span class="op">,</span> maxBalls<span class="op">+</span>dy<span class="op">/</span><span class="dv">2</span>])</span>
<span id="cb5-964"><a href="#cb5-964" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>([visHeight<span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb5-965"><a href="#cb5-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-966"><a href="#cb5-966" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating the x-axis and the y-axis, and their labels</span></span>
<span id="cb5-967"><a href="#cb5-967" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-968"><a href="#cb5-968" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating the x-axis</span></span>
<span id="cb5-969"><a href="#cb5-969" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xAxis <span class="op">=</span> (g<span class="op">,</span> scale<span class="op">,</span> label) <span class="kw">=&gt;</span></span>
<span id="cb5-970"><a href="#cb5-970" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span>visHeight<span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb5-971"><a href="#cb5-971" aria-hidden="true" tabindex="-1"></a>        <span class="co">// add axis</span></span>
<span id="cb5-972"><a href="#cb5-972" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisBottom</span>(scale))</span>
<span id="cb5-973"><a href="#cb5-973" aria-hidden="true" tabindex="-1"></a>      <span class="co">// add label</span></span>
<span id="cb5-974"><a href="#cb5-974" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb5-975"><a href="#cb5-975" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> visWidth <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb5-976"><a href="#cb5-976" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb5-977"><a href="#cb5-977" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb5-978"><a href="#cb5-978" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb5-979"><a href="#cb5-979" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb5-980"><a href="#cb5-980" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"18"</span>)</span>
<span id="cb5-981"><a href="#cb5-981" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(label)</span>
<span id="cb5-982"><a href="#cb5-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-983"><a href="#cb5-983" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating the y-axis</span></span>
<span id="cb5-984"><a href="#cb5-984" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yAxis <span class="op">=</span> (g<span class="op">,</span> scale<span class="op">,</span> label) <span class="kw">=&gt;</span> </span>
<span id="cb5-985"><a href="#cb5-985" aria-hidden="true" tabindex="-1"></a>    <span class="co">// add axis</span></span>
<span id="cb5-986"><a href="#cb5-986" aria-hidden="true" tabindex="-1"></a>    g<span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisLeft</span>(scale))</span>
<span id="cb5-987"><a href="#cb5-987" aria-hidden="true" tabindex="-1"></a>      <span class="co">// add label</span></span>
<span id="cb5-988"><a href="#cb5-988" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb5-989"><a href="#cb5-989" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"rotate(-90)"</span>)</span>
<span id="cb5-990"><a href="#cb5-990" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="op">-</span>visHeight<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb5-991"><a href="#cb5-991" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="op">-</span>margin<span class="op">.</span><span class="at">left</span><span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb5-992"><a href="#cb5-992" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb5-993"><a href="#cb5-993" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb5-994"><a href="#cb5-994" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb5-995"><a href="#cb5-995" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"18"</span>)</span>
<span id="cb5-996"><a href="#cb5-996" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(label)</span>
<span id="cb5-997"><a href="#cb5-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-998"><a href="#cb5-998" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating the svg inside the visualization margins of the chart: this is where things can be drawn</span></span>
<span id="cb5-999"><a href="#cb5-999" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb5-1000"><a href="#cb5-1000" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> visWidth <span class="op">+</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">right</span>)</span>
<span id="cb5-1001"><a href="#cb5-1001" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> visHeight <span class="op">+</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">bottom</span>)<span class="op">;</span></span>
<span id="cb5-1002"><a href="#cb5-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1003"><a href="#cb5-1003" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating a main group to add things to visualize</span></span>
<span id="cb5-1004"><a href="#cb5-1004" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> g <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb5-1005"><a href="#cb5-1005" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb5-1006"><a href="#cb5-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1007"><a href="#cb5-1007" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Attach axes to the main group</span></span>
<span id="cb5-1008"><a href="#cb5-1008" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">call</span>(xAxis<span class="op">,</span> xScale<span class="op">,</span> <span class="st">"Strike-rate in each innings →"</span>)<span class="op">;</span></span>
<span id="cb5-1009"><a href="#cb5-1009" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">call</span>(yAxis<span class="op">,</span> yScale<span class="op">,</span> <span class="st">"No. of balls faced in each innings →"</span>)<span class="op">;</span></span>
<span id="cb5-1010"><a href="#cb5-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1011"><a href="#cb5-1011" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Change axes tick label fontsize</span></span>
<span id="cb5-1012"><a href="#cb5-1012" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)</span>
<span id="cb5-1013"><a href="#cb5-1013" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb5-1014"><a href="#cb5-1014" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb5-1015"><a href="#cb5-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1016"><a href="#cb5-1016" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb5-1017"><a href="#cb5-1017" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> visWidth)</span>
<span id="cb5-1018"><a href="#cb5-1018" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> visHeight)</span>
<span id="cb5-1019"><a href="#cb5-1019" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#000000"</span>)</span>
<span id="cb5-1020"><a href="#cb5-1020" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb5-1021"><a href="#cb5-1021" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)<span class="op">;</span></span>
<span id="cb5-1022"><a href="#cb5-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1023"><a href="#cb5-1023" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Drawing grid lines</span></span>
<span id="cb5-1024"><a href="#cb5-1024" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> grid <span class="op">=</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)<span class="op">;</span></span>
<span id="cb5-1025"><a href="#cb5-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1026"><a href="#cb5-1026" aria-hidden="true" tabindex="-1"></a>  grid<span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb5-1027"><a href="#cb5-1027" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> visWidth)</span>
<span id="cb5-1028"><a href="#cb5-1028" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> visHeight)</span>
<span id="cb5-1029"><a href="#cb5-1029" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'white'</span>)<span class="op">;</span></span>
<span id="cb5-1030"><a href="#cb5-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1031"><a href="#cb5-1031" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> yLines <span class="op">=</span> grid<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb5-1032"><a href="#cb5-1032" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'line'</span>)<span class="op">;</span></span>
<span id="cb5-1033"><a href="#cb5-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1034"><a href="#cb5-1034" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> xLines <span class="op">=</span> grid<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb5-1035"><a href="#cb5-1035" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'line'</span>)<span class="op">;</span></span>
<span id="cb5-1036"><a href="#cb5-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1037"><a href="#cb5-1037" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawGridLines</span>(x<span class="op">,</span> y) {</span>
<span id="cb5-1038"><a href="#cb5-1038" aria-hidden="true" tabindex="-1"></a>    yLines <span class="op">=</span> yLines<span class="op">.</span><span class="fu">data</span>(y<span class="op">.</span><span class="fu">ticks</span>())</span>
<span id="cb5-1039"><a href="#cb5-1039" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">'line'</span>)</span>
<span id="cb5-1040"><a href="#cb5-1040" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'#d3d3d3'</span>)</span>
<span id="cb5-1041"><a href="#cb5-1041" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x1'</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb5-1042"><a href="#cb5-1042" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x2'</span><span class="op">,</span> visWidth)</span>
<span id="cb5-1043"><a href="#cb5-1043" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y1'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fu">y</span>(d))</span>
<span id="cb5-1044"><a href="#cb5-1044" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y2'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fu">y</span>(d))<span class="op">;</span></span>
<span id="cb5-1045"><a href="#cb5-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1046"><a href="#cb5-1046" aria-hidden="true" tabindex="-1"></a>    xLines <span class="op">=</span> xLines<span class="op">.</span><span class="fu">data</span>(x<span class="op">.</span><span class="fu">ticks</span>())</span>
<span id="cb5-1047"><a href="#cb5-1047" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">'line'</span>)</span>
<span id="cb5-1048"><a href="#cb5-1048" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'#d3d3d3'</span>)</span>
<span id="cb5-1049"><a href="#cb5-1049" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x1'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fu">x</span>(d))</span>
<span id="cb5-1050"><a href="#cb5-1050" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x2'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fu">x</span>(d))</span>
<span id="cb5-1051"><a href="#cb5-1051" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y1'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="dv">0</span>)</span>
<span id="cb5-1052"><a href="#cb5-1052" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y2'</span><span class="op">,</span> d <span class="kw">=&gt;</span> visHeight)<span class="op">;</span></span>
<span id="cb5-1053"><a href="#cb5-1053" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-1054"><a href="#cb5-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1055"><a href="#cb5-1055" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Allows to re-draw grid lines whenever necessary: like zooming in or updating the domains of the x and y axes</span></span>
<span id="cb5-1056"><a href="#cb5-1056" aria-hidden="true" tabindex="-1"></a>  <span class="co">// drawGridLines(xScale, yScale);</span></span>
<span id="cb5-1057"><a href="#cb5-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1058"><a href="#cb5-1058" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Setting up a clipPath to hide data points outside of the visualization area </span></span>
<span id="cb5-1059"><a href="#cb5-1059" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">'clipPath'</span>)</span>
<span id="cb5-1060"><a href="#cb5-1060" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'id'</span><span class="op">,</span> <span class="st">'border2'</span>)</span>
<span id="cb5-1061"><a href="#cb5-1061" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb5-1062"><a href="#cb5-1062" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> visWidth)</span>
<span id="cb5-1063"><a href="#cb5-1063" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> visHeight)<span class="op">;</span></span>
<span id="cb5-1064"><a href="#cb5-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1065"><a href="#cb5-1065" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Setting up a group containing the base scatter points</span></span>
<span id="cb5-1066"><a href="#cb5-1066" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> baseCirclesGroup <span class="op">=</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb5-1067"><a href="#cb5-1067" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'clip-path'</span><span class="op">,</span> <span class="st">'url(#border2)'</span>)<span class="op">;</span></span>
<span id="cb5-1068"><a href="#cb5-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1069"><a href="#cb5-1069" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Creating a tooltip that is hidden by default</span></span>
<span id="cb5-1070"><a href="#cb5-1070" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tooltip <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb5-1071"><a href="#cb5-1071" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"tp"</span>)</span>
<span id="cb5-1072"><a href="#cb5-1072" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)<span class="op">;</span></span>
<span id="cb5-1073"><a href="#cb5-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1074"><a href="#cb5-1074" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Setting up some values before starting to plot</span></span>
<span id="cb5-1075"><a href="#cb5-1075" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> baseRadius <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb5-1076"><a href="#cb5-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1077"><a href="#cb5-1077" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">rectBinner</span>(xData<span class="op">,</span> yData<span class="op">,</span> dx<span class="op">,</span> dy) {</span>
<span id="cb5-1078"><a href="#cb5-1078" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> xMin <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(xData)</span>
<span id="cb5-1079"><a href="#cb5-1079" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> xMax <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(xData)</span>
<span id="cb5-1080"><a href="#cb5-1080" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> yMin <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(yData)</span>
<span id="cb5-1081"><a href="#cb5-1081" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> yMax <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(yData)</span>
<span id="cb5-1082"><a href="#cb5-1082" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> nx <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>((xMax<span class="op">-</span>xMin)<span class="op">/</span>dx) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb5-1083"><a href="#cb5-1083" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ny <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>((yMax<span class="op">-</span>yMin)<span class="op">/</span>dy) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb5-1084"><a href="#cb5-1084" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> RectCount <span class="op">=</span> []</span>
<span id="cb5-1085"><a href="#cb5-1085" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> x <span class="op">=</span> xMin <span class="op">-</span> dx<span class="op">/</span><span class="dv">2</span></span>
<span id="cb5-1086"><a href="#cb5-1086" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> y <span class="op">=</span> yMin <span class="op">-</span> dy<span class="op">/</span><span class="dv">2</span></span>
<span id="cb5-1087"><a href="#cb5-1087" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(nx<span class="op">*</span>ny<span class="op">*</span><span class="dv">2</span>)<span class="op">.</span><span class="fu">forEach</span>( <span class="kw">function</span>(xx<span class="op">,</span> i) {</span>
<span id="cb5-1088"><a href="#cb5-1088" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (y<span class="op">&gt;</span>yMax) {</span>
<span id="cb5-1089"><a href="#cb5-1089" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> RectCount</span>
<span id="cb5-1090"><a href="#cb5-1090" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-1091"><a href="#cb5-1091" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (x<span class="op">&gt;</span>xMax) {</span>
<span id="cb5-1092"><a href="#cb5-1092" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> xMin <span class="op">-</span> dx<span class="op">/</span><span class="dv">2</span><span class="op">;</span></span>
<span id="cb5-1093"><a href="#cb5-1093" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> y <span class="op">+</span> dy<span class="op">;</span></span>
<span id="cb5-1094"><a href="#cb5-1094" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb5-1095"><a href="#cb5-1095" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Do something</span></span>
<span id="cb5-1096"><a href="#cb5-1096" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-1097"><a href="#cb5-1097" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">range</span>(xData<span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(xx<span class="op">,</span> i) {</span>
<span id="cb5-1098"><a href="#cb5-1098" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (xData[xx]<span class="op">&gt;=</span>x <span class="op">&amp;&amp;</span> xData[xx]<span class="op">&lt;</span>(x<span class="op">+</span>dx) <span class="op">&amp;&amp;</span> yData[xx]<span class="op">&gt;=</span>y <span class="op">&amp;&amp;</span> yData[xx]<span class="op">&lt;</span>(y<span class="op">+</span>dy)){</span>
<span id="cb5-1099"><a href="#cb5-1099" aria-hidden="true" tabindex="-1"></a>            count <span class="op">=</span> count <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb5-1100"><a href="#cb5-1100" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb5-1101"><a href="#cb5-1101" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb5-1102"><a href="#cb5-1102" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (count<span class="op">&gt;</span><span class="dv">0</span>) {</span>
<span id="cb5-1103"><a href="#cb5-1103" aria-hidden="true" tabindex="-1"></a>          RectCount<span class="op">.</span><span class="fu">push</span>({<span class="st">"x"</span><span class="op">:</span> x<span class="op">,</span> <span class="st">"y"</span><span class="op">:</span> y<span class="op">,</span> <span class="st">"c"</span><span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">log10</span>(count)})<span class="op">;</span></span>
<span id="cb5-1104"><a href="#cb5-1104" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-1105"><a href="#cb5-1105" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> x <span class="op">+</span> dx<span class="op">;</span></span>
<span id="cb5-1106"><a href="#cb5-1106" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-1107"><a href="#cb5-1107" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb5-1108"><a href="#cb5-1108" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> RectCount</span>
<span id="cb5-1109"><a href="#cb5-1109" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-1110"><a href="#cb5-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1111"><a href="#cb5-1111" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> inningsColor <span class="op">=</span> []</span>
<span id="cb5-1112"><a href="#cb5-1112" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">range</span>(data<span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(xx<span class="op">,</span> i) {</span>
<span id="cb5-1113"><a href="#cb5-1113" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (data[xx]<span class="op">.</span><span class="at">Name</span><span class="op">==</span>chosen_batter) {</span>
<span id="cb5-1114"><a href="#cb5-1114" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">range</span>(data<span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(yy<span class="op">,</span> j) {</span>
<span id="cb5-1115"><a href="#cb5-1115" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (data[xx]<span class="op">.</span><span class="at">Won</span>[yy]<span class="op">==</span><span class="st">"Yes"</span>){</span>
<span id="cb5-1116"><a href="#cb5-1116" aria-hidden="true" tabindex="-1"></a>            inningsColor<span class="op">.</span><span class="fu">push</span>(<span class="st">"#B4BA39"</span>)<span class="op">;</span></span>
<span id="cb5-1117"><a href="#cb5-1117" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb5-1118"><a href="#cb5-1118" aria-hidden="true" tabindex="-1"></a>            inningsColor<span class="op">.</span><span class="fu">push</span>(<span class="st">"#FF6B6C"</span>)<span class="op">;</span></span>
<span id="cb5-1119"><a href="#cb5-1119" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb5-1120"><a href="#cb5-1120" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb5-1121"><a href="#cb5-1121" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-1122"><a href="#cb5-1122" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb5-1123"><a href="#cb5-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1124"><a href="#cb5-1124" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawPoints</span>(in_data) {</span>
<span id="cb5-1125"><a href="#cb5-1125" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Select all circles in the group and append a data point to each</span></span>
<span id="cb5-1126"><a href="#cb5-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1127"><a href="#cb5-1127" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> rectCounts <span class="op">=</span> <span class="fu">rectBinner</span>(in_data[<span class="dv">0</span>]<span class="op">,</span> in_data[<span class="dv">1</span>]<span class="op">,</span> dx<span class="op">,</span> dy)</span>
<span id="cb5-1128"><a href="#cb5-1128" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> color <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleSequential</span>(d3<span class="op">.</span><span class="at">interpolateGreys</span>)</span>
<span id="cb5-1129"><a href="#cb5-1129" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(rectCounts<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">c</span>) <span class="op">/</span> <span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb5-1130"><a href="#cb5-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1131"><a href="#cb5-1131" aria-hidden="true" tabindex="-1"></a>    baseCirclesGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb5-1132"><a href="#cb5-1132" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#000"</span>)</span>
<span id="cb5-1133"><a href="#cb5-1133" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-opacity"</span><span class="op">,</span> <span class="fl">0.2</span>)</span>
<span id="cb5-1134"><a href="#cb5-1134" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"rect"</span>)</span>
<span id="cb5-1135"><a href="#cb5-1135" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(rectCounts)</span>
<span id="cb5-1136"><a href="#cb5-1136" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"rect"</span>)</span>
<span id="cb5-1137"><a href="#cb5-1137" aria-hidden="true" tabindex="-1"></a>      <span class="co">// .attr("transform", d =&gt; `translate(${d.x},${d.y})`)</span></span>
<span id="cb5-1138"><a href="#cb5-1138" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">xScale</span>(d<span class="op">.</span><span class="at">x</span>))</span>
<span id="cb5-1139"><a href="#cb5-1139" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">yScale</span>(d<span class="op">.</span><span class="at">y</span>))</span>
<span id="cb5-1140"><a href="#cb5-1140" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> <span class="fu">xScale</span>(dx)<span class="op">-</span><span class="fu">xScale</span>(<span class="dv">0</span>))</span>
<span id="cb5-1141"><a href="#cb5-1141" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">0</span>)<span class="op">-</span><span class="fu">yScale</span>(dy))</span>
<span id="cb5-1142"><a href="#cb5-1142" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">color</span>(d<span class="op">.</span><span class="at">c</span>))</span>
<span id="cb5-1143"><a href="#cb5-1143" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.75</span>)<span class="op">;</span></span>
<span id="cb5-1144"><a href="#cb5-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1145"><a href="#cb5-1145" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(data<span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(xx<span class="op">,</span> i) {</span>
<span id="cb5-1146"><a href="#cb5-1146" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (data[xx]<span class="op">.</span><span class="at">Name</span><span class="op">==</span>chosen_batter) {</span>
<span id="cb5-1147"><a href="#cb5-1147" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">range</span>(data<span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(yy<span class="op">,</span> j) {</span>
<span id="cb5-1148"><a href="#cb5-1148" aria-hidden="true" tabindex="-1"></a>          baseCirclesGroup</span>
<span id="cb5-1149"><a href="#cb5-1149" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">append</span>(<span class="st">'circle'</span>)</span>
<span id="cb5-1150"><a href="#cb5-1150" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"innings_circles"</span>)</span>
<span id="cb5-1151"><a href="#cb5-1151" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="fu">xScale</span>(data[xx]<span class="op">.</span><span class="at">SR</span>[yy]<span class="op">+</span>(d3<span class="op">.</span><span class="fu">randomUniform</span>(<span class="dv">1</span>)()<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb5-1152"><a href="#cb5-1152" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="fu">yScale</span>(data[xx]<span class="op">.</span><span class="at">Balls</span>[yy]<span class="op">+</span>(d3<span class="op">.</span><span class="fu">randomUniform</span>(<span class="dv">1</span>)()<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb5-1153"><a href="#cb5-1153" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> data[xx]<span class="op">.</span><span class="at">Won</span>[yy]<span class="op">==</span><span class="st">"Yes"</span><span class="op">?</span> <span class="st">"#B4BA39"</span><span class="op">:</span> <span class="st">"#FF6B6C"</span>)</span>
<span id="cb5-1154"><a href="#cb5-1154" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">4</span>)</span>
<span id="cb5-1155"><a href="#cb5-1155" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">"#ffffff"</span>)</span>
<span id="cb5-1156"><a href="#cb5-1156" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb5-1157"><a href="#cb5-1157" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">'opacity'</span><span class="op">,</span> <span class="fl">0.75</span>)</span>
<span id="cb5-1158"><a href="#cb5-1158" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Interactive functions:</span></span>
<span id="cb5-1159"><a href="#cb5-1159" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseenter"</span><span class="op">,</span> <span class="kw">function</span>(e){</span>
<span id="cb5-1160"><a href="#cb5-1160" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mouseEnter</span>(e<span class="op">,</span> yy)</span>
<span id="cb5-1161"><a href="#cb5-1161" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb5-1162"><a href="#cb5-1162" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseleave"</span><span class="op">,</span> <span class="kw">function</span>(e){</span>
<span id="cb5-1163"><a href="#cb5-1163" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mouseLeave</span>(e<span class="op">,</span> yy)</span>
<span id="cb5-1164"><a href="#cb5-1164" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb5-1165"><a href="#cb5-1165" aria-hidden="true" tabindex="-1"></a>            <span class="co">// .on("click", clicked);</span></span>
<span id="cb5-1166"><a href="#cb5-1166" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb5-1167"><a href="#cb5-1167" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb5-1168"><a href="#cb5-1168" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-1169"><a href="#cb5-1169" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb5-1170"><a href="#cb5-1170" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-1171"><a href="#cb5-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1172"><a href="#cb5-1172" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Function to draw equi-run lines, given an array of runs</span></span>
<span id="cb5-1173"><a href="#cb5-1173" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> line <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb5-1174"><a href="#cb5-1174" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> SR_linspace</span>
<span id="cb5-1175"><a href="#cb5-1175" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawEquiRunLines</span>(eqrs) {</span>
<span id="cb5-1176"><a href="#cb5-1176" aria-hidden="true" tabindex="-1"></a>    SR_linspace <span class="op">=</span> d3<span class="op">.</span><span class="fu">ticks</span>(xScale<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">0</span>]<span class="op">,</span> xScale<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>]<span class="op">,</span> <span class="dv">1000</span>)<span class="op">;</span>    </span>
<span id="cb5-1177"><a href="#cb5-1177" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> balls_eqr</span>
<span id="cb5-1178"><a href="#cb5-1178" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> eqr_points</span>
<span id="cb5-1179"><a href="#cb5-1179" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Equi-run lines</span></span>
<span id="cb5-1180"><a href="#cb5-1180" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> eqrs<span class="op">.</span><span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) { </span>
<span id="cb5-1181"><a href="#cb5-1181" aria-hidden="true" tabindex="-1"></a>      balls_eqr <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>()<span class="op">;</span></span>
<span id="cb5-1182"><a href="#cb5-1182" aria-hidden="true" tabindex="-1"></a>      eqr_points <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>()<span class="op">;</span></span>
<span id="cb5-1183"><a href="#cb5-1183" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> SR_linspace<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) { </span>
<span id="cb5-1184"><a href="#cb5-1184" aria-hidden="true" tabindex="-1"></a>        balls_eqr<span class="op">.</span><span class="fu">push</span>(eqrs[j]<span class="op">*</span><span class="dv">100</span><span class="op">/</span>SR_linspace[i])<span class="op">;</span></span>
<span id="cb5-1185"><a href="#cb5-1185" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (balls_eqr[i]<span class="op">&gt;=</span>yScale<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">0</span>] <span class="op">&amp;&amp;</span> balls_eqr[i]<span class="op">&lt;=</span>yScale<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>]) {</span>
<span id="cb5-1186"><a href="#cb5-1186" aria-hidden="true" tabindex="-1"></a>          eqr_points<span class="op">.</span><span class="fu">push</span>([<span class="fu">xScale</span>(SR_linspace[i])<span class="op">,</span> <span class="fu">yScale</span>(balls_eqr[i])])<span class="op">;</span></span>
<span id="cb5-1187"><a href="#cb5-1187" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-1188"><a href="#cb5-1188" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-1189"><a href="#cb5-1189" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-1190"><a href="#cb5-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1191"><a href="#cb5-1191" aria-hidden="true" tabindex="-1"></a>      g<span class="op">.</span><span class="fu">append</span>(<span class="st">'path'</span>)</span>
<span id="cb5-1192"><a href="#cb5-1192" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"main_eqr_lines"</span>)</span>
<span id="cb5-1193"><a href="#cb5-1193" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> <span class="fu">line</span>(eqr_points))</span>
<span id="cb5-1194"><a href="#cb5-1194" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'#a3a3a3'</span>)</span>
<span id="cb5-1195"><a href="#cb5-1195" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> (<span class="st">"10,3"</span>))</span>
<span id="cb5-1196"><a href="#cb5-1196" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)<span class="op">;</span></span>
<span id="cb5-1197"><a href="#cb5-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1198"><a href="#cb5-1198" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Labeling the equi-run lines on the right-side of the plot</span></span>
<span id="cb5-1199"><a href="#cb5-1199" aria-hidden="true" tabindex="-1"></a>      g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb5-1200"><a href="#cb5-1200" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"main_eqr_run_labels"</span>)</span>
<span id="cb5-1201"><a href="#cb5-1201" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="st">"0.5em"</span>)</span>
<span id="cb5-1202"><a href="#cb5-1202" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb5-1203"><a href="#cb5-1203" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb5-1204"><a href="#cb5-1204" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> textColor)</span>
<span id="cb5-1205"><a href="#cb5-1205" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">yScale</span>(eqrs[j]<span class="op">*</span><span class="dv">100</span><span class="op">/</span>(xScale<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>]))) <span class="co">// offset it from the edge of the rectangle</span></span>
<span id="cb5-1206"><a href="#cb5-1206" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">xScale</span>(xScale<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>])) <span class="co">// offset it from the edge of the rectangle</span></span>
<span id="cb5-1207"><a href="#cb5-1207" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb5-1208"><a href="#cb5-1208" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".0f"</span>)(eqrs[j])<span class="op">+</span><span class="st">" runs"</span>)<span class="op">;</span></span>
<span id="cb5-1209"><a href="#cb5-1209" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-1210"><a href="#cb5-1210" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-1211"><a href="#cb5-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1212"><a href="#cb5-1212" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Calling function to draw equi-run lines</span></span>
<span id="cb5-1213"><a href="#cb5-1213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawEquiRunLines</span>([<span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">40</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">60</span><span class="op">,</span> <span class="dv">75</span><span class="op">,</span> <span class="dv">100</span>])</span>
<span id="cb5-1214"><a href="#cb5-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1215"><a href="#cb5-1215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawPoints</span>([all_SR<span class="op">,</span> all_balls]<span class="op">,</span> chosen_batter)<span class="op">;</span></span>
<span id="cb5-1216"><a href="#cb5-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1217"><a href="#cb5-1217" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">getFirstLetters</span>(str) {</span>
<span id="cb5-1218"><a href="#cb5-1218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> firstLetters <span class="op">=</span> str</span>
<span id="cb5-1219"><a href="#cb5-1219" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">split</span>(<span class="st">' '</span>)</span>
<span id="cb5-1220"><a href="#cb5-1220" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">map</span>(word <span class="kw">=&gt;</span> word[<span class="dv">0</span>])</span>
<span id="cb5-1221"><a href="#cb5-1221" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">''</span>)<span class="op">;</span></span>
<span id="cb5-1222"><a href="#cb5-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1223"><a href="#cb5-1223" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> firstLetters<span class="op">;</span></span>
<span id="cb5-1224"><a href="#cb5-1224" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-1225"><a href="#cb5-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1226"><a href="#cb5-1226" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">mouseEnter</span>(<span class="bu">event</span><span class="op">,</span> yy) {</span>
<span id="cb5-1227"><a href="#cb5-1227" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-1228"><a href="#cb5-1228" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Change opacity of all scatter points on hover</span></span>
<span id="cb5-1229"><a href="#cb5-1229" aria-hidden="true" tabindex="-1"></a>    baseCirclesGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'circle'</span>)</span>
<span id="cb5-1230"><a href="#cb5-1230" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb5-1231"><a href="#cb5-1231" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.75</span>)</span>
<span id="cb5-1232"><a href="#cb5-1232" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#d3d3d3"</span>)<span class="op">;</span></span>
<span id="cb5-1233"><a href="#cb5-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1234"><a href="#cb5-1234" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">.</span><span class="fu">select</span>(<span class="st">"#tp"</span>)</span>
<span id="cb5-1235"><a href="#cb5-1235" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb5-1236"><a href="#cb5-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1237"><a href="#cb5-1237" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> xPos <span class="op">=</span> <span class="fl">0.8</span><span class="op">*</span><span class="fu">xScale</span>(xScale<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>])</span>
<span id="cb5-1238"><a href="#cb5-1238" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> yPos <span class="op">=</span> <span class="fl">0.1</span><span class="op">*</span><span class="fu">yScale</span>(yScale<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">0</span>])</span>
<span id="cb5-1239"><a href="#cb5-1239" aria-hidden="true" tabindex="-1"></a>    tooltip</span>
<span id="cb5-1240"><a href="#cb5-1240" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>xPos<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span>yPos<span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb5-1241"><a href="#cb5-1241" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"visible"</span>)<span class="op">;</span></span>
<span id="cb5-1242"><a href="#cb5-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1243"><a href="#cb5-1243" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(data<span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(xx<span class="op">,</span> i) {</span>
<span id="cb5-1244"><a href="#cb5-1244" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (data[xx]<span class="op">.</span><span class="at">Name</span><span class="op">==</span>chosen_batter) {</span>
<span id="cb5-1245"><a href="#cb5-1245" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb5-1246"><a href="#cb5-1246" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"0em"</span>)</span>
<span id="cb5-1247"><a href="#cb5-1247" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb5-1248"><a href="#cb5-1248" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">20</span>)</span>
<span id="cb5-1249"><a href="#cb5-1249" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> greyTextColor)</span>
<span id="cb5-1250"><a href="#cb5-1250" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb5-1251"><a href="#cb5-1251" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb5-1252"><a href="#cb5-1252" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(data[xx]<span class="op">.</span><span class="at">Name</span>)<span class="op">;</span></span>
<span id="cb5-1253"><a href="#cb5-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1254"><a href="#cb5-1254" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb5-1255"><a href="#cb5-1255" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"1.1em"</span>) <span class="co">// you can vary how far apart it shows up</span></span>
<span id="cb5-1256"><a href="#cb5-1256" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb5-1257"><a href="#cb5-1257" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">18</span>)</span>
<span id="cb5-1258"><a href="#cb5-1258" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> greyTextColor)</span>
<span id="cb5-1259"><a href="#cb5-1259" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb5-1260"><a href="#cb5-1260" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(data[xx]<span class="op">.</span><span class="at">Runs</span>[yy]<span class="op">+</span><span class="st">" ("</span><span class="op">+</span>data[xx]<span class="op">.</span><span class="at">Balls</span>[yy]<span class="op">+</span><span class="st">")"</span>)<span class="op">;</span></span>
<span id="cb5-1261"><a href="#cb5-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1262"><a href="#cb5-1262" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb5-1263"><a href="#cb5-1263" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"2.6em"</span>) <span class="co">// you can vary how far apart it shows up</span></span>
<span id="cb5-1264"><a href="#cb5-1264" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb5-1265"><a href="#cb5-1265" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb5-1266"><a href="#cb5-1266" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> greyTextColor)</span>
<span id="cb5-1267"><a href="#cb5-1267" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb5-1268"><a href="#cb5-1268" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(<span class="fu">getFirstLetters</span>(data[xx]<span class="op">.</span><span class="at">Team</span>[yy])<span class="op">+</span><span class="st">" vs "</span><span class="op">+</span><span class="fu">getFirstLetters</span>(data[xx]<span class="op">.</span><span class="at">OppTeam</span>[yy])<span class="op">+</span><span class="st">" ("</span><span class="op">+</span>data[xx]<span class="op">.</span><span class="at">TeamType</span>[yy]<span class="op">+</span><span class="st">")"</span>)<span class="op">;</span></span>
<span id="cb5-1269"><a href="#cb5-1269" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-1270"><a href="#cb5-1270" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb5-1271"><a href="#cb5-1271" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"3.7em"</span>) <span class="co">// you can vary how far apart it shows up</span></span>
<span id="cb5-1272"><a href="#cb5-1272" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"roboto"</span>)</span>
<span id="cb5-1273"><a href="#cb5-1273" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb5-1274"><a href="#cb5-1274" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> greyTextColor)</span>
<span id="cb5-1275"><a href="#cb5-1275" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"hanging"</span>)</span>
<span id="cb5-1276"><a href="#cb5-1276" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(data[xx]<span class="op">.</span><span class="at">Date</span>[yy])<span class="op">;</span></span>
<span id="cb5-1277"><a href="#cb5-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1278"><a href="#cb5-1278" aria-hidden="true" tabindex="-1"></a>        <span class="bu">event</span><span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">r</span><span class="op">.</span><span class="at">baseVal</span><span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb5-1279"><a href="#cb5-1279" aria-hidden="true" tabindex="-1"></a>        <span class="bu">event</span><span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">opacity</span> <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-1280"><a href="#cb5-1280" aria-hidden="true" tabindex="-1"></a>        <span class="bu">event</span><span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">fill</span> <span class="op">=</span> data[xx]<span class="op">.</span><span class="at">Won</span>[yy]<span class="op">==</span><span class="st">"Yes"</span><span class="op">?</span> <span class="st">"#B4BA39"</span><span class="op">:</span> <span class="st">"#FF6B6C"</span></span>
<span id="cb5-1281"><a href="#cb5-1281" aria-hidden="true" tabindex="-1"></a>         <span class="bu">event</span><span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">stroke</span> <span class="op">=</span> <span class="st">"#ffffff"</span></span>
<span id="cb5-1282"><a href="#cb5-1282" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-1283"><a href="#cb5-1283" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb5-1284"><a href="#cb5-1284" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-1285"><a href="#cb5-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1286"><a href="#cb5-1286" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">mouseLeave</span>(<span class="bu">event</span>) {</span>
<span id="cb5-1287"><a href="#cb5-1287" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">.</span><span class="fu">attr</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)<span class="op">;</span></span>
<span id="cb5-1288"><a href="#cb5-1288" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb5-1289"><a href="#cb5-1289" aria-hidden="true" tabindex="-1"></a>    baseCirclesGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".innings_circles"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb5-1290"><a href="#cb5-1290" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(data<span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(xx<span class="op">,</span> i) {</span>
<span id="cb5-1291"><a href="#cb5-1291" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (data[xx]<span class="op">.</span><span class="at">Name</span><span class="op">==</span>chosen_batter) {</span>
<span id="cb5-1292"><a href="#cb5-1292" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">range</span>(data<span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(yy<span class="op">,</span> j) {</span>
<span id="cb5-1293"><a href="#cb5-1293" aria-hidden="true" tabindex="-1"></a>          baseCirclesGroup</span>
<span id="cb5-1294"><a href="#cb5-1294" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">append</span>(<span class="st">'circle'</span>)</span>
<span id="cb5-1295"><a href="#cb5-1295" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"innings_circles"</span>)</span>
<span id="cb5-1296"><a href="#cb5-1296" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="fu">xScale</span>(data[xx]<span class="op">.</span><span class="at">SR</span>[yy]<span class="op">+</span>(d3<span class="op">.</span><span class="fu">randomUniform</span>(<span class="dv">1</span>)()<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb5-1297"><a href="#cb5-1297" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="fu">yScale</span>(data[xx]<span class="op">.</span><span class="at">Balls</span>[yy]<span class="op">+</span>(d3<span class="op">.</span><span class="fu">randomUniform</span>(<span class="dv">1</span>)()<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb5-1298"><a href="#cb5-1298" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> data[xx]<span class="op">.</span><span class="at">Won</span>[yy]<span class="op">==</span><span class="st">"Yes"</span><span class="op">?</span> <span class="st">"#B4BA39"</span><span class="op">:</span> <span class="st">"#FF6B6C"</span>)</span>
<span id="cb5-1299"><a href="#cb5-1299" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">4</span>)</span>
<span id="cb5-1300"><a href="#cb5-1300" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">"#ffffff"</span>)</span>
<span id="cb5-1301"><a href="#cb5-1301" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb5-1302"><a href="#cb5-1302" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">'opacity'</span><span class="op">,</span> <span class="fl">0.75</span>)</span>
<span id="cb5-1303"><a href="#cb5-1303" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Interactive functions:</span></span>
<span id="cb5-1304"><a href="#cb5-1304" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseenter"</span><span class="op">,</span> <span class="kw">function</span>(e){</span>
<span id="cb5-1305"><a href="#cb5-1305" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mouseEnter</span>(e<span class="op">,</span> yy)</span>
<span id="cb5-1306"><a href="#cb5-1306" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb5-1307"><a href="#cb5-1307" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseleave"</span><span class="op">,</span> <span class="kw">function</span>(e){</span>
<span id="cb5-1308"><a href="#cb5-1308" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mouseLeave</span>(e<span class="op">,</span> yy)</span>
<span id="cb5-1309"><a href="#cb5-1309" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb5-1310"><a href="#cb5-1310" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb5-1311"><a href="#cb5-1311" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb5-1312"><a href="#cb5-1312" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-1313"><a href="#cb5-1313" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb5-1314"><a href="#cb5-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-1315"><a href="#cb5-1315" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-1316"><a href="#cb5-1316" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb5-1317"><a href="#cb5-1317" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:ital@0;1&amp;display=swap"></p>


</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"data = FileAttachment(\"data/ipl_batter_SR_balls.json\").json();\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"all_batter_names = data.map(row => row.Name)\n"},{"methodName":"interpret","cellName":"ojs-cell-3","inline":false,"source":"\n/* ----------------------------------------------------------\nInteractive plot showing average strike-rates and balls faced\n-------------------------------------------------------------*/\n{\n  // Setting up the overall chart dimensions\n  const margin = ({top: 20, right: 150, bottom: 50, left: 60})\n  const visWidth = 450\n  const visHeight = 450\n\n  var textColor = d3.select(\"p\").style(\"color\")\n  const greyTextColor = \"#212529\"\n\n  // Setting up x and y scales to map from data values to pixel values\n  const extentSR = [d3.min(data, function(d){return Math.min.apply(Math, [d.AvSRWin, d.AvSRLoss])}),\n                d3.max(data, function(d){return Math.max.apply(Math, [d.AvSRWin, d.AvSRLoss])})]; \n\n  const extentBalls = [d3.min(data, function(d){return Math.min.apply(Math, [d.AvBallsWin, d.AvBallsLoss])}),\n                d3.max(data, function(d){return Math.max.apply(Math, [d.AvBallsWin, d.AvBallsLoss])})]; \n\n  // Linear x-scale, domain and range set\n  const x = d3.scaleLinear()\n        .domain(extentSR).nice()\n        .range([0, visWidth]);\n\n  // Linear y-scale, domain and range set\n  const y = d3.scaleLinear()\n        .domain(extentBalls).nice()\n        .range([visHeight, 0]);\n\n  // Creating the x-axis and the y-axis, and their labels\n  \n  // Creating the x-axis\n  const xAxis = (g, scale, label) =>\n    g.attr(\"transform\", `translate(0, ${visHeight})`)\n        // add axis\n        .call(d3.axisBottom(scale))\n      // add label\n      .append(\"text\")\n        .attr(\"x\", visWidth / 2)\n        .attr(\"y\", margin.bottom-5)\n        .attr(\"fill\", textColor)\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"font-family\", \"roboto\")\n        .attr(\"font-size\", \"18\")\n        .text(label)\n\n  // Creating the y-axis\n  const yAxis = (g, scale, label) => \n    // add axis\n    g.call(d3.axisLeft(scale))\n      // add label\n      .append(\"text\")\n        .attr(\"transform\", \"rotate(-90)\")\n        .attr(\"x\", -visHeight/2)\n        .attr(\"y\", -margin.left+20)\n        .attr(\"fill\", textColor)\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"font-family\", \"roboto\")\n        .attr(\"font-size\", \"18\")\n        .text(label)\n\n  // Creating the svg inside the visualization margins of the chart: this is where things can be drawn\n  const svg = d3.create(\"svg\")\n      .attr(\"width\", visWidth + margin.left + margin.right)\n      .attr(\"height\", visHeight + margin.top + margin.bottom);\n      \n  /* svg.append(\"rect\")\n    .attr(\"width\", \"100%\")\n    .attr(\"height\", \"100%\")\n    .attr(\"fill\", \"#ffffff\"); */\n\n  // Creating a main group to add things to visualize\n  const g = svg.append(\"g\")\n      .attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n\n  // Attach axes to the main group\n  g.append(\"g\").call(xAxis, x, \"Average strike-rate in innings →\");\n  g.append(\"g\").call(yAxis, y, \"Average no. of balls faced in innings →\");\n  // Change axes tick label fontsize\n  g.selectAll(\".tick text\")\n    .attr(\"font-size\", 15)\n    .attr(\"font-family\", \"roboto\")\n\n  // Drawing grid lines\n  const grid = g.append('g');\n  \n  grid.append('rect')\n    .attr('width', visWidth)\n    .attr('height', visHeight)\n    .attr('fill', 'white');\n\n  let yLines = grid.append('g')\n    .selectAll('line');\n\n  let xLines = grid.append('g')\n    .selectAll('line');\n\n  function drawGridLines(x, y) {\n    yLines = yLines.data(y.ticks())\n      .join('line')\n        .attr('stroke', '#d3d3d3')\n        .attr('x1', 0)\n        .attr('x2', visWidth)\n        .attr('y1', d => 0.5 + y(d))\n        .attr('y2', d => 0.5 + y(d));\n\n    xLines = xLines.data(x.ticks())\n      .join('line')\n        .attr('stroke', '#d3d3d3')\n        .attr('x1', d => 0.5 + x(d))\n        .attr('x2', d => 0.5 + x(d))\n        .attr('y1', d => 0)\n        .attr('y2', d => visHeight);\n  }\n\n  // Allows to re-draw grid lines whenever necessary: like zooming in or updating the domains of the x and y axes\n  drawGridLines(x, y);\n\n  // Setting up a clipPath to hide data points outside of the visualization area \n  g.append('clipPath')\n      .attr('id', 'border')\n    .append('rect')\n      .attr('width', visWidth)\n      .attr('height', visHeight);\n\n  g.append('rect')\n      .attr('width', visWidth)\n      .attr('height', visHeight)\n      .attr(\"stroke\", \"#000000\")\n      .style(\"stroke-width\", 1)\n      .attr('fill', 'none');\n\n  // Setting up a group containing the base scatter points\n  const baseCirclesGroup = g.append('g')\n      .attr('clip-path', 'url(#border)');\n\n  // Setting up a group containing the hover graphic elements\n  const hoverElementsGroup = g.append('g')\n      .attr('clip-path', 'url(#border)');\n\n  // Creating a tooltip that is hidden by default\n  const tooltip = g.append(\"g\")\n      .attr(\"id\", \"tp\")\n      .attr(\"visibility\", \"hidden\");\n\n  // Creating the x-axis\n  const xAxisSide = (g, scale) =>\n    g.attr(\"transform\", `translate(0, 100)`)\n        // add axis\n        .call(d3.axisBottom(scale).ticks(10));\n        // .call(g => g.select(\".domain\").remove());\n\n  // Creating the y-axis\n  const yAxisSide = (g, scale) => \n    // add axis\n    g.call(d3.axisLeft(scale).ticks(10));\n    //.call(g => g.select(\".domain\").remove());\n\n  const sideAxisX = margin.left + visWidth + 30\n  const sideAxisY = margin.top + 120\n\n  var sideAxisGroupTop = svg.append(\"g\")\n      .attr(\"class\", \"side_axis\")\n      .attr(\"transform\", `translate(${sideAxisX}, ${sideAxisY})`);\n\n  sideAxisGroupTop.append('rect')\n      .attr('width', 100)\n      .attr('height', 100)\n      .attr(\"stroke\", \"#000000\")\n      .style(\"stroke-width\", 1)\n      .attr('fill', 'none')\n      .attr(\"visibility\", \"hidden\");\n\n  const sideAxisYAdded = sideAxisY + 120\n\n  var sideAxisGroupBottom = svg.append(\"g\")\n      .attr(\"class\", \"side_axis\")\n      .attr(\"transform\", `translate(${sideAxisX}, ${sideAxisYAdded})`);\n\n  sideAxisGroupBottom.append('rect')\n      .attr('width', 100)\n      .attr('height', 100)\n      .attr(\"stroke\", \"#000000\")\n      .style(\"stroke-width\", 1)\n      .attr('fill', 'none')\n      .attr(\"visibility\", \"hidden\");\n\n  var all_SR = []\n  var all_balls = []\n  d3.range(data.length).forEach(function(xx, i) {\n    all_SR = d3.merge([all_SR, data[xx].SR])\n    all_balls = d3.merge([all_balls, data[xx].Balls]) \n  });\n  const minSR = d3.min(all_SR)\n  const maxSR = d3.quantile(all_SR, 0.99)\n  const minBalls = d3.min(all_balls)\n  const maxBalls = d3.max(all_balls)\n\n  const xSide = d3.scaleLinear()\n          .domain([minSR, maxSR])\n          .range([0, 100]);\n\n  // Linear y-scale, domain and range set\n  const ySide = d3.scaleLinear()\n        .domain([minBalls, maxBalls])\n        .range([100, 0]);\n\n  // Setting up a group containing the base scatter points\n  const sideCirclesGroupTop = sideAxisGroupTop.append('g');\n  const sideCirclesGroupBottom = sideAxisGroupBottom.append('g');\n\n  // Setting up some values before starting to plot\n  const baseRadius = 5\n  const BattingPositions = [\"Openers\", \"Middle-order\", \"Finishers\", \"Tail-enders\"]\n  const battingPositionColor = d3.scaleOrdinal()\n    .domain(BattingPositions)\n    .range(d3.schemeCategory10);\n\n  // Drawing the base scatter points by attaching it to the data\n  function drawPoints(in_data) {\n\n    const meanBalls = d3.mean(in_data, function(d) {return d.AvBalls});\n    var xMin = x.domain()[0];\n    var xMax = x.domain()[1];\n\n    const meanSR = d3.mean(in_data, function(d) {return d.AvSR});\n    var yMin = y.domain()[0];\n    var yMax = y.domain()[1];\n\n    // Select all circles in the group and append a data point to each\n    const baseCircles = baseCirclesGroup.selectAll('circle')\n      .data(in_data)\n      .join('circle')\n        // draw points\n        .attr(\"cx\", d => x(d.AvSR))\n        .attr(\"cy\", d => y(d.AvBalls))\n        .attr(\"fill\", d =>  battingPositionColor(d.BattingPosition))\n        .attr(\"r\", baseRadius)\n        .attr('stroke', \"none\")\n        .attr('stroke-width', 1)\n        .attr('opacity', 0.5)\n        // Interactive functions:\n        .on(\"mouseenter\", mouseEnter)\n        .on(\"mouseleave\", mouseLeave)\n        .on(\"click\", clicked);\n\n    // Adding a horizontal line\n    g.append('line')\n      .attr(\"id\", \"mean_balls\")\n      .attr(\"x1\", x(xMin))\n      .attr(\"y1\", y(meanBalls))\n      .attr(\"x2\", x(xMax))\n      .attr(\"y2\", y(meanBalls))\n      .style(\"stroke\", \"red\");\n\n    // Adding a vertical line\n    g.append('line')\n      .attr(\"id\", \"mean_sr\")\n      .attr(\"x1\", x(meanSR))\n      .attr(\"y1\", y(yMin))\n      .attr(\"x2\", x(meanSR))\n      .attr(\"y2\", y(yMax))\n      .style(\"stroke\", \"red\");\n\n  }\n\n  // Function to draw equi-run lines, given an array of runs\n  var line = d3.line()\n  var SR_linspace\n  function drawEquiRunLines(eqrs) {\n    SR_linspace = d3.ticks(x.domain()[0], x.domain()[1], 1000);    \n    var balls_eqr\n    var eqr_points\n    // Equi-run lines\n    for (let j = 0; j < eqrs.length; j++) { \n      balls_eqr = new Array();\n      eqr_points = new Array();\n      for (let i = 0; i < SR_linspace.length; i++) { \n        balls_eqr.push(eqrs[j]*100/SR_linspace[i]);\n        if (balls_eqr[i]>=y.domain()[0] && balls_eqr[i]<=y.domain()[1]) {\n          eqr_points.push([x(SR_linspace[i]), y(balls_eqr[i])]);\n        }\n        \n      }\n\n      g.append('path')\n        .attr(\"class\", \"main_eqr_lines\")\n        .attr('d', line(eqr_points))\n        .attr('stroke', '#a3a3a3')\n        .style(\"stroke-dasharray\", (\"10,3\"))\n        .attr('fill', 'none');\n\n      // Labeling the equi-run lines on the right-side of the plot\n      g.append(\"text\")\n        .attr(\"class\", \"main_eqr_run_labels\")\n        .attr(\"dx\", \"0.5em\")\n        .attr(\"font-family\", \"roboto\")\n        .attr(\"font-size\", 15)\n        .attr(\"fill\", textColor)\n        .attr(\"y\", y(eqrs[j]*100/(x.domain()[1]))) // offset it from the edge of the rectangle\n        .attr(\"x\", x(x.domain()[1])) // offset it from the edge of the rectangle\n        .attr(\"dominant-baseline\", \"middle\")\n        .text(d3.format(\".0f\")(eqrs[j])+\" runs\");\n    }\n  }\n\n  // Calling function to draw equi-run lines\n  drawEquiRunLines([10, 20, 30, 40, 50])\n\n  // Calling function to draw the base scatter plot on the given axes\n  drawPoints(data)\n\n  function dragstarted() {\n    d3.select(this).attr(\"stroke\", \"black\");\n  }\n\n  function dragged(event, d) {\n    d3.select(this).raise().attr(\"cx\", d.x = event.x).attr(\"cy\", d.y = event.y);\n  }\n\n  function dragended() {\n    d3.select(this).attr(\"stroke\", null);\n  }\n\n  var drag = d3.drag()\n      .on(\"start\", dragstarted)\n      .on(\"drag\", dragged)\n      .on(\"end\", dragended);\n\n  // Track which batting-positions are selected\n  const highlighted = new Map(data.map(d => [d, true]));\n\n  // Function to handle mouse enter events\n  function mouseEnter(event, d, i) {\n    \n    // Remove labeling of highlighted labels, and equi-run lines\n    g.selectAll(\".highlighted_labels\").remove()\n    g.selectAll(\".main_eqr_lines\").attr(\"visibility\", \"hidden\");\n    g.selectAll(\".main_eqr_run_labels\").attr(\"visibility\", \"hidden\");\n\n    // y.domain([70,100])\n\n    // Define the arrowhead marker variables\n    const markerBoxWidth = 10;\n    const markerBoxHeight = 10;\n    const refX = markerBoxWidth / 2;\n    const refY = markerBoxHeight / 2;\n    const markerWidth = markerBoxWidth / 2;\n    const markerHeight = markerBoxHeight / 2;\n    const arrowPoints = [[0, 0], [0, 10], [10, 5]];\n\n    // Add the arrowhead marker definition to the svg element\n    svg\n      .append('defs')\n      .append('marker')\n        .attr('id', 'arrow')\n        .attr('viewBox', [0, 0, markerBoxWidth, markerBoxHeight])\n        .attr('refX', refX)\n        .attr('refY', refY)\n        .attr('markerWidth', markerBoxWidth)\n        .attr('markerHeight', markerBoxHeight)\n        .attr('orient', 'auto-start-reverse')\n      .append('path')\n        .attr('d', d3.line()(arrowPoints))\n        .attr('stroke', 'black');\n\n    // Change opacity of all scatter points on hover\n    baseCirclesGroup.selectAll('circle')\n      .attr(\"stroke\", \"none\")\n      .attr(\"opacity\", 0.75)\n      .attr(\"fill\", \"#d3d3d3\");\n\n    var eqrs = [d.AvBallsLoss*d.AvSRLoss/100, d.AvBalls*d.AvSR/100, d.AvBallsWin*d.AvSRWin/100]\n    var loss_runs_positions = [\"hanging\", \"middle\", \"bottom\"]\n    var balls_eqr\n    var eqr_points\n    // Equi-run lines\n    for (let j = 0; j < eqrs.length; j++) { \n      balls_eqr = new Array();\n      eqr_points = new Array();\n      for (let i = 0; i < SR_linspace.length; i++) { \n        balls_eqr.push(eqrs[j]*100/SR_linspace[i]);\n        if (balls_eqr[i]>=y.domain()[0] && balls_eqr[i]<=y.domain()[1]) {\n          eqr_points.push([x(SR_linspace[i]), y(balls_eqr[i])]);\n        } \n      }\n      hoverElementsGroup.append('path')\n        .attr(\"class\", \"hover_eqr_lines\")\n        .attr(\"pointer-events\", \"none\")\n        .attr('d', line(eqr_points))\n        .attr('stroke', '#a3a3a3')\n        .style(\"stroke-dasharray\", (\"10,3\"))\n        .attr('fill', 'none');\n\n      if (j>0) {\n        if (Math.round(eqrs[j])==Math.round(eqrs[j-1])) {\n          continue;\n        }\n      }\n\n      g.append(\"text\")\n        .attr(\"class\", \"loss_runs\")\n        .attr(\"dx\", \"0.5em\")\n        .attr(\"font-family\", \"roboto\")\n        .attr(\"font-size\", 15)\n        .attr(\"fill\", greyTextColor)\n        .attr(\"y\", y(eqrs[j]*100/(x.domain()[1]))) // offset it from the edge of the rectangle\n        .attr(\"x\", x(x.domain()[1])-60) // offset it from the edge of the rectangle\n        .attr(\"dominant-baseline\", function(){ \n          if ((eqrs[2]>eqrs[0] && j==0) || (eqrs[2]<eqrs[0] && j==2)) {\n            return \"hanging\"\n          }\n          if ((eqrs[2]>eqrs[0] && j==2) || (eqrs[2]<eqrs[0] && j==0)) {\n            return \"bottom\"\n          }\n          if (j==1) {\n            return \"middle\"\n          }\n        })\n        .text(d3.format(\".0f\")(eqrs[j])+\" runs\");\n    }\n\n    hoverElementsGroup.append(\"circle\")\n        .attr(\"id\", \"win_sr_circle\")\n        .attr(\"pointer-events\", \"none\")\n        .attr(\"cx\", x(d.AvSRWin))\n        .attr(\"cy\", y(d.AvBallsWin))\n        .attr(\"fill\", \"none\")\n        .attr(\"r\", 8)\n        .attr('stroke', \"#000000\")\n        .attr('stroke-width', 1)\n        .attr('opacity', 1);\n\n    hoverElementsGroup.append('line')\n      .style('stroke', 'black')\n      .attr(\"id\", \"loss_win\")\n      .attr(\"pointer-events\", \"none\")\n      .attr('marker-end', 'url(#arrow)')\n      .attr(\"x1\", x(d.AvSRLoss))\n      .attr(\"y1\", y(d.AvBallsLoss))\n      .attr(\"x2\", x(d.AvSRWin))\n      .attr(\"y2\", y(d.AvBallsWin));\n\n    hoverElementsGroup.append(\"circle\")\n        .attr(\"id\", \"loss_sr_circle\")\n        .attr(\"pointer-events\", \"none\")\n        .attr(\"cx\", x(d.AvSRLoss))\n        .attr(\"cy\", y(d.AvBallsLoss))\n        .attr(\"fill\", \"#000000\")\n        .attr(\"r\", 5)\n        .attr('stroke', \"#ffffff\")\n        .attr('stroke-width', 1)\n        .attr('opacity', 1);\n\n    hoverElementsGroup.append(\"text\")\n      .attr(\"id\", \"loss_label\")\n      .attr(\"pointer-events\", \"none\")\n      .attr(\"dy\", \"-1em\")\n      .attr(\"dx\", d.AvSRWin>d.AvSRLoss? \"1em\" : \"-1em\")\n      .attr(\"font-family\", \"roboto\")\n      .attr(\"font-size\", 15)\n      //.attr(\"font-weight\", \"bold\")\n      .attr(\"fill\", greyTextColor)\n      .attr(\"y\", y(d.AvBallsLoss)) // offset it from the edge of the rectangle\n      .attr(\"x\", x(d.AvSRLoss)) // offset it from the edge of the rectangle\n      .attr(\"dominant-baseline\", \"middle\")\n      .attr(\"text-anchor\", d.AvSRWin>d.AvSRLoss? \"end\" : \"start\")\n      .text(\"Loss\");\n\n    hoverElementsGroup.append(\"text\")\n      .attr(\"id\", \"win_label\")\n      .attr(\"pointer-events\", \"none\")\n      .attr(\"dy\", \"-1em\")\n      .attr(\"dx\", d.AvSRWin>d.AvSRLoss? \"1em\" : \"-1em\")\n      .attr(\"font-family\", \"roboto\")\n      .attr(\"font-size\", 15)\n      // .attr(\"font-weight\", \"bold\")\n      .attr(\"fill\", greyTextColor)\n      .attr(\"y\", y(d.AvBallsWin)) // offset it from the edge of the rectangle\n      .attr(\"x\", x(d.AvSRWin)) // offset it from the edge of the rectangle\n      .attr(\"dominant-baseline\", \"middle\")\n      .attr(\"text-anchor\", d.AvSRWin>d.AvSRLoss? \"end\" : \"start\")\n      .text(\"Win\");\n\n    tooltip.select(\"#tp\")\n      .raise();\n\n    hoverElementsGroup.append(\"text\")\n    .attr(\"pointer-events\", \"none\")\n      .attr(\"id\", \"av_label\")\n      .attr(\"dy\", \"-1.2em\")\n      .attr(\"dx\", \"-0.5em\")\n      .attr(\"font-family\", \"roboto\")\n      .attr(\"font-size\", 15)\n      // .attr(\"font-weight\", \"bold\")\n      .attr(\"fill\", greyTextColor)\n      .attr(\"y\", y(d.AvBalls)) // offset it from the edge of the rectangle\n      .attr(\"x\", x(d.AvSR)) // offset it from the edge of the rectangle\n      .attr(\"dominant-baseline\", \"bottom\")\n      .text(\"All\");\n\n    // tooltipText.html(d.Name);\n    tooltip.append(\"text\")\n      .attr(\"dy\", \"0em\")\n      .attr(\"font-family\", \"roboto\")\n      .attr(\"font-size\", 20)\n      .attr(\"font-weight\", \"bold\")\n      .attr(\"fill\", greyTextColor)\n      .attr(\"dominant-baseline\", \"hanging\")\n      .text(d.Name);\n\n    var diff_sr = d.AvSRWin - d.AvSRLoss\n    tooltip.append(\"text\")\n      .attr(\"dy\", \"1.1em\") // you can vary how far apart it shows up\n      .attr(\"font-family\", \"roboto\")\n      .attr(\"font-size\", 18)\n      .attr(\"dominant-baseline\", \"hanging\")\n      .text(\"SR: \"+d3.format(\".1f\")(d.AvSR))\n      .attr(\"fill\", greyTextColor)\n      .append(\"tspan\")\n        .attr(\"font-family\", \"roboto\")\n        .attr(\"font-size\", 15)\n        .attr(\"fill\", greyTextColor)\n        .attr(\"dominant-baseline\", \"hanging\")\n        .text(diff_sr>0? \" +\"+d3.format(\".0f\")(diff_sr): \" \"+d3.format(\".0f\")(diff_sr))\n        .attr(\"fill\", diff_sr>0? \"green\": \"red\");\n\n    var diff_balls = d.AvBallsWin - d.AvBallsLoss\n\n    tooltip.append(\"text\")\n      .attr(\"dy\", \"2.1em\") // you can vary how far apart it shows up\n      .attr(\"font-family\", \"roboto\")\n      .attr(\"font-size\", 18)\n      .attr(\"fill\", greyTextColor)\n      .attr(\"dominant-baseline\", \"hanging\")\n      .text(\"Balls: \"+d3.format(\".0f\")(d.AvBalls))\n      .append(\"tspan\")\n        .attr(\"font-family\", \"roboto\")\n        .attr(\"font-size\", 15)\n        .attr(\"fill\", greyTextColor)\n        .attr(\"dominant-baseline\", \"hanging\")\n        .text(diff_balls>0? \" +\"+d3.format(\".0f\")(diff_balls): \" \"+d3.format(\".0f\")(diff_balls))\n        .attr(\"fill\", diff_balls>0? \"green\": \"red\");\n    \n    d3.select(this)\n        .attr(\"r\", baseRadius * 3)\n        .attr('opacity', 1)\n        .raise()\n        .attr(\"fill\", battingPositionColor(d.BattingPosition));\n\n    const xPos = 0.7*x(x.domain()[1])\n    const yPos = 0.1*y(y.domain()[0])\n    tooltip\n      .attr(\"transform\", `translate(${xPos},${yPos})`)\n      .attr(\"visibility\", \"visible\");\n\n    // Add a side axis group for innings_points\n    // Linear x-scale, domain and range set\n    // xSide.domain(d3.extent(d.SR)).nice();\n    // ySide.domain(d3.extent(d.Balls)).nice();\n\n    // Making side axis group visible\n    sideAxisGroupTop.attr(\"visibility\", \"visible\");\n\n    // Attach axes to the main group\n    sideAxisGroupTop.append(\"g\").call(xAxisSide, xSide);\n    sideAxisGroupTop.append(\"g\").call(yAxisSide, ySide);\n\n    sideAxisGroupTop.selectAll(\".tick line\")\n      .attr(\"visibility\", \"hidden\");\n    \n    sideAxisGroupTop.selectAll(\"text\").remove()\n\n    sideAxisGroupBottom.attr(\"visibility\", \"visible\");\n\n    // Attach axes to the main group\n    sideAxisGroupBottom.append(\"g\").call(xAxisSide, xSide);\n    sideAxisGroupBottom.append(\"g\").call(yAxisSide, ySide);\n\n    sideAxisGroupBottom.selectAll(\".tick line\")\n      .attr(\"visibility\", \"hidden\");\n    \n    sideAxisGroupBottom.selectAll(\"text\").remove()\n\n    sideAxisGroupBottom.append(\"text\")\n      .attr(\"font-family\", \"roboto\")\n      .attr(\"font-size\", 15)\n      .attr(\"fill\", textColor)\n      .attr(\"font-weight\", \"bold\")\n      .attr(\"dy\", -5)\n      .attr(\"dx\", 100)\n      .attr(\"dominant-baseline\", \"hanging\")\n      .attr(\"text-anchor\", \"end\")\n      .text(\"Wins\");\n\n    sideAxisGroupTop.append(\"text\")\n      .attr(\"font-family\", \"roboto\")\n      .attr(\"font-size\", 15)\n      .attr(\"fill\", textColor)\n      .attr(\"font-weight\", \"bold\")\n      .attr(\"dy\", -5)\n      .attr(\"dx\", 100)\n      .attr(\"dominant-baseline\", \"hanging\")\n      .attr(\"text-anchor\", \"end\")\n      .text(\"Losses\");\n\n    sideAxisGroupBottom.append(\"text\")\n      .attr(\"font-family\", \"roboto\")\n      .attr(\"font-size\", 15)\n      .attr(\"fill\", textColor)\n      .attr(\"dy\", 110)\n      .attr(\"dx\", -3)\n      .attr(\"dominant-baseline\", \"hanging\")\n      .text(minSR);\n\n    sideAxisGroupBottom.append(\"text\")\n      .attr(\"font-family\", \"roboto\")\n      .attr(\"font-size\", 15)\n      .attr(\"fill\", textColor)\n      .attr(\"dy\", 110)\n      .attr(\"dx\", 90)\n      .attr(\"dominant-baseline\", \"hanging\")\n      .text(maxSR);\n\n    sideAxisGroupBottom.append(\"text\")\n      .attr(\"font-family\", \"roboto\")\n      .attr(\"font-size\", 15)\n      .attr(\"fill\", textColor)\n      .attr(\"dy\", 0)\n      .attr(\"dx\", -10)\n      .attr(\"dominant-baseline\", \"middle\")\n      .attr(\"text-anchor\", \"end\")\n      .text(maxBalls);\n\n    sideAxisGroupBottom.append(\"text\")\n      .attr(\"font-family\", \"roboto\")\n      .attr(\"font-size\", 15)\n      .attr(\"fill\", textColor)\n      .attr(\"dy\", 100)\n      .attr(\"dx\", -10)\n      .attr(\"dominant-baseline\", \"middle\")\n      .attr(\"text-anchor\", \"end\")\n      .text(minBalls);\n\n    d3.range(d.SR.length).forEach(function(xx, i) {\n      sideCirclesGroupTop.append('circle')\n        .attr(\"class\", \"innings_points\")\n        // .attr('clip-path', 'url(#border)')\n        .attr(\"pointer-events\", \"none\")\n        .attr(\"cx\", xSide(d.SR[xx]))\n        .attr(\"cy\", ySide(d.Balls[xx]))\n        .attr(\"r\", 6)\n        .attr(\"opacity\", 0.5)\n        .style(\"fill\", \"#b3b3b3\")\n        .style(\"stroke\", \"none\");\n\n      sideCirclesGroupBottom.append('circle')\n        .attr(\"class\", \"innings_points\")\n        // .attr('clip-path', 'url(#border)')\n        .attr(\"pointer-events\", \"none\")\n        .attr(\"cx\", xSide(d.SR[xx]))\n        .attr(\"cy\", ySide(d.Balls[xx]))\n        .attr(\"r\", 6)\n        .attr(\"opacity\", 0.5)\n        .style(\"fill\", \"#b3b3b3\")\n        .style(\"stroke\", \"none\");\n\n    });\n\n    d3.range(d.SR.length).forEach(function(xx, i) {\n      if (d.Won[xx]==\"No\") {\n        sideCirclesGroupTop.append('circle')\n          .attr(\"class\", \"innings_points\")\n          // .attr('clip-path', 'url(#border)')\n          .attr(\"pointer-events\", \"none\")\n          .attr(\"cx\", xSide(d.SR[xx]))\n          .attr(\"cy\", ySide(d.Balls[xx]))\n          .attr(\"r\", 2)\n          .style(\"fill\", \"#FF6B6C\")\n          .style(\"stroke\", \"#000000\")\n          .style(\"stroke-width\", 1);\n      }\n\n      if (d.Won[xx]==\"Yes\") {\n        sideCirclesGroupBottom.append('circle')\n          .attr(\"class\", \"innings_points\")\n          // .attr('clip-path', 'url(#border)')\n          .attr(\"pointer-events\", \"none\")\n          .attr(\"cx\", xSide(d.SR[xx]))\n          .attr(\"cy\", ySide(d.Balls[xx]))\n          .attr(\"r\", 2)\n          .style(\"fill\", \"#B4BA39\")\n          .style(\"stroke\", \"#000000\")\n          .style(\"stroke-width\", 1);\n      }\n    });\n  }\n\n  // Function to handle mouse leaving\n  function mouseLeave(event, d) {\n\n    sideAxisGroupTop.attr(\"visibility\", \"hidden\")\n    sideAxisGroupBottom.attr(\"visibility\", \"hidden\")\n    sideCirclesGroupTop.selectAll(\".innings_points\").remove()\n    sideCirclesGroupBottom.selectAll(\".innings_points\").remove()\n    g.select(\"#loss_win\").remove()\n    hoverElementsGroup.select(\"#loss_sr_circle\").remove()\n    hoverElementsGroup.select(\"#win_sr_circle\").remove()\n    hoverElementsGroup.select(\"#loss_label\").remove()\n    hoverElementsGroup.select(\"#win_label\").remove()\n    hoverElementsGroup.select(\"#av_label\").remove()\n    hoverElementsGroup.selectAll(\".hover_eqr_lines\").remove()\n    hoverElementsGroup.selectAll(\".innings_points\").remove()\n    g.selectAll(\".highlighted_labels\").remove()\n    g.selectAll(\".loss_runs\").remove()\n    g.selectAll(\".main_eqr_lines\")\n        .attr(\"visibility\", \"visible\");\n    g.selectAll(\".main_eqr_run_labels\")\n        .attr(\"visibility\", \"visible\");\n\n    baseCirclesGroup.selectAll('circle')\n      .attr(\"stroke\", d => highlighted.get(d)? \"none\" : \"black\")\n      .attr(\"opacity\", d => highlighted.get(d)? 0.5 : 1)\n      .attr(\"fill\", d =>  battingPositionColor(d.BattingPosition));\n\n    baseCirclesGroup.selectAll('circle')  //here's how you get all the nodes\n      .each(function(d) {\n        if (!highlighted.get(d)) {\n          g.append('text')\n          .attr('class', 'highlighted_labels')\n          .style('fill', greyTextColor)\n          .attr(\"font-family\", \"roboto\")\n          .attr(\"font-size\", 15)\n          .attr(\"font-weight\", \"bold\")\n          .attr(\"dominant-baseline\", \"alphabetical\")\n          .attr(\"text-anchor\", \"start\")\n          .attr(\"x\", x(d.AvSR)+baseRadius+1)\n          .attr(\"y\", y(d.AvBalls)-baseRadius-1)\n          .text(d.Name);\n        }\n      });\n\n    // reset the size of the circle\n    d3.select(this)\n      .attr(\"r\", d => highlighted.get(d)? baseRadius : baseRadius * 1.5)\n      .attr(\"stroke\", d => highlighted.get(d)? \"none\" : \"black\")\n      .attr(\"opacity\", d => highlighted.get(d)? 0.5 : 1);\n    \n    tooltip.selectAll(\"text\").remove()\n    \n    // make the tooltip invisible\n    tooltip\n        .attr(\"visibility\", \"hidden\");\n  }\n\n  // Function to handle mouse clicks\n  function clicked(event, d) {\n\n    const isHighlighted = highlighted.get(d);\n\n    d3.select(this)\n        .raise()\n        .attr(\"stroke\", d => isHighlighted? \"black\" : \"none\")\n        .attr(\"opacity\", d => isHighlighted? 1 : 0.75);\n\n    d3.select(this)\n        .append(\"text\")\n        .attr(\"font-family\", \"roboto\")\n        .attr(\"font-size\", 22)\n        .attr(\"font-weight\", \"bold\")\n        .attr(\"dominant-baseline\", \"hanging\")\n        .text(d.Wins);\n        \n    highlighted.set(d, !isHighlighted);\n    \n  }\n\n  // Draw legend\n  const xShift = visWidth + margin.left\n  const yShift = margin.top - 10\n  const legend = svg.append('g')\n      .attr('transform', `translate(${xShift}, ${yShift})`);\n  \n  legend.append(\"text\")\n    .text(\"Select type:\")\n    .attr('font-size', 15)\n    .attr('dominant-baseline', 'middle')\n    .attr(\"fill\", textColor)\n    .attr('text-anchor', 'start')\n    .attr('font-family', 'roboto')\n    .attr('x', 10)\n    .attr('y', 5);\n\n  const rows = legend.selectAll('g')\n    .data(BattingPositions)\n    .join('g')\n      .attr('transform', (d, i) => `translate(20, ${(i+1) * 20})`);\n  \n  rows.append('rect')\n      .attr('width', 15)\n      .attr('height', 15)\n      .attr('stroke-width', 2)\n      .attr('stroke', d => battingPositionColor(d))\n      .attr('fill', d => battingPositionColor(d))\n      .on('click', onclick);\n  \n  rows.append('text')\n      .attr('font-size', 15)\n      .attr('x', 20)\n      .attr('y', 7.5)\n      .attr(\"fill\", textColor)\n      .attr('font-family', 'roboto')\n      .attr('dominant-baseline', 'middle')\n      .text(d => d)\n\n  // Track which batting-positions are selected\n  const selected = new Map(BattingPositions.map(d => [d, true]));\n\n  function onclick(event, d) {\n    const isSelected = selected.get(d);\n    \n    // select the square and toggle it\n    const square = d3.select(this);\n    square.attr('fill', d => isSelected ? 'white' : battingPositionColor(d));\n    selected.set(d, !isSelected);\n    \n    // redraw the points\n    svg.select(\"#mean_balls\").remove()\n    svg.select(\"#mean_sr\").remove()\n    g.selectAll(\".highlighted_labels\").remove()\n    drawPoints(data.filter(d => selected.get(d.BattingPosition)));\n\n    baseCirclesGroup.selectAll('circle')  //here's how you get all the nodes\n      .each(function(d) {\n        if (!highlighted.get(d)) {\n          g.append('text')\n            .attr('class', 'highlighted_labels')\n            .style('fill', greyTextColor)\n            .attr(\"font-family\", \"roboto\")\n            .attr(\"font-size\", 15)\n            .attr(\"font-weight\", \"bold\")\n            .attr(\"dominant-baseline\", \"alphabetical\")\n            .attr(\"text-anchor\", \"start\")\n            .attr(\"x\", x(d.AvSR)+baseRadius+1)\n            .attr(\"y\", y(d.AvBalls)-baseRadius-1)\n            .text(d.Name);\n            //.call(drag);\n            //.call(d3.drag().on(\"start\", dragstarted))\n            //.call(d3.drag().on(\"drag\", dragged))\n            //.call(d3.drag().on(\"end\", dragended));\n        }\n      });\n\n    baseCirclesGroup.selectAll('circle')\n      .attr(\"stroke\", d => highlighted.get(d)? \"none\" : \"black\")\n      .attr(\"r\", d => highlighted.get(d)? baseRadius : baseRadius * 1.5)\n      .attr(\"opacity\", d => highlighted.get(d)? 0.25 : 1)\n      .attr(\"fill\", d =>  battingPositionColor(d.BattingPosition));\n\n  }\n\n  return svg.node();\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-4","inline":false,"source":"// [\"V Kohli\", \"AB de Villiers\", \"MS Dhoni\"]\nviewof chosen_batter = Inputs.select(all_batter_names, {value: 'V Kohli', label: 'Choose batter'})\n"},{"methodName":"interpret","cellName":"ojs-cell-5","inline":false,"source":"{\n  // Setting up the overall chart dimensions\n  const margin = ({top: 5, right: 65, bottom: 50, left: 60})\n  const visWidth = 600\n  const visHeight = 400\n\n  var textColor = d3.select(\"p\").style(\"color\")\n  const greyTextColor = \"#212529\"\n\n  var all_SR = []\n  var all_balls = []\n  d3.range(data.length).forEach(function(xx, i) {\n    all_SR = d3.merge([all_SR, data[xx].SR])\n    all_balls = d3.merge([all_balls, data[xx].Balls]) \n  });\n  const minSR = d3.min(all_SR)\n  const maxSR = d3.quantile(all_SR, 0.99)\n  const minBalls = d3.min(all_balls)\n  const maxBalls = d3.max(all_balls)\n  const dx = 10\n  const dy = 4\n\n  const xScale = d3.scaleLinear()\n          .domain([minSR-dx/2, maxSR+dx/2])\n          .range([0, visWidth]);\n\n  // Linear y-scale, domain and range set\n  const yScale = d3.scaleLinear()\n        .domain([minBalls-dy/2, maxBalls+dy/2])\n        .range([visHeight, 0]);\n\n  // Creating the x-axis and the y-axis, and their labels\n  \n  // Creating the x-axis\n  const xAxis = (g, scale, label) =>\n    g.attr(\"transform\", `translate(0, ${visHeight})`)\n        // add axis\n        .call(d3.axisBottom(scale))\n      // add label\n      .append(\"text\")\n        .attr(\"x\", visWidth / 2)\n        .attr(\"y\", margin.bottom-5)\n        .attr(\"fill\", textColor)\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"font-family\", \"roboto\")\n        .attr(\"font-size\", \"18\")\n        .text(label)\n\n  // Creating the y-axis\n  const yAxis = (g, scale, label) => \n    // add axis\n    g.call(d3.axisLeft(scale))\n      // add label\n      .append(\"text\")\n        .attr(\"transform\", \"rotate(-90)\")\n        .attr(\"x\", -visHeight/2)\n        .attr(\"y\", -margin.left+20)\n        .attr(\"fill\", textColor)\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"font-family\", \"roboto\")\n        .attr(\"font-size\", \"18\")\n        .text(label)\n\n  // Creating the svg inside the visualization margins of the chart: this is where things can be drawn\n  const svg = d3.create(\"svg\")\n      .attr(\"width\", visWidth + margin.left + margin.right)\n      .attr(\"height\", visHeight + margin.top + margin.bottom);\n\n  // Creating a main group to add things to visualize\n  const g = svg.append(\"g\")\n      .attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n\n  // Attach axes to the main group\n  g.append(\"g\").call(xAxis, xScale, \"Strike-rate in each innings →\");\n  g.append(\"g\").call(yAxis, yScale, \"No. of balls faced in each innings →\");\n\n  // Change axes tick label fontsize\n  g.selectAll(\".tick text\")\n    .attr(\"font-size\", 15)\n    .attr(\"font-family\", \"roboto\")\n\n  g.append('rect')\n      .attr('width', visWidth)\n      .attr('height', visHeight)\n      .attr(\"stroke\", \"#000000\")\n      .style(\"stroke-width\", 1)\n      .attr('fill', 'none');\n\n  // Drawing grid lines\n  const grid = g.append('g');\n\n  grid.append('rect')\n    .attr('width', visWidth)\n    .attr('height', visHeight)\n    .attr('fill', 'white');\n\n  let yLines = grid.append('g')\n    .selectAll('line');\n\n  let xLines = grid.append('g')\n    .selectAll('line');\n\n  function drawGridLines(x, y) {\n    yLines = yLines.data(y.ticks())\n      .join('line')\n        .attr('stroke', '#d3d3d3')\n        .attr('x1', 0)\n        .attr('x2', visWidth)\n        .attr('y1', d => 0.5 + y(d))\n        .attr('y2', d => 0.5 + y(d));\n\n    xLines = xLines.data(x.ticks())\n      .join('line')\n        .attr('stroke', '#d3d3d3')\n        .attr('x1', d => 0.5 + x(d))\n        .attr('x2', d => 0.5 + x(d))\n        .attr('y1', d => 0)\n        .attr('y2', d => visHeight);\n  }\n\n  // Allows to re-draw grid lines whenever necessary: like zooming in or updating the domains of the x and y axes\n  // drawGridLines(xScale, yScale);\n\n  // Setting up a clipPath to hide data points outside of the visualization area \n  g.append('clipPath')\n      .attr('id', 'border2')\n    .append('rect')\n      .attr('width', visWidth)\n      .attr('height', visHeight);\n\n  // Setting up a group containing the base scatter points\n  const baseCirclesGroup = g.append('g')\n      .attr('clip-path', 'url(#border2)');\n\n  // Creating a tooltip that is hidden by default\n  const tooltip = svg.append(\"g\")\n      .attr(\"id\", \"tp\")\n      .attr(\"visibility\", \"hidden\");\n\n  // Setting up some values before starting to plot\n  const baseRadius = 8\n\n  function rectBinner(xData, yData, dx, dy) {\n    const xMin = d3.min(xData)\n    const xMax = d3.max(xData)\n    const yMin = d3.min(yData)\n    const yMax = d3.max(yData)\n    const nx = Math.round((xMax-xMin)/dx) + 1\n    const ny = Math.round((yMax-yMin)/dy) + 1\n    var RectCount = []\n    let x = xMin - dx/2\n    let y = yMin - dy/2\n    d3.range(nx*ny*2).forEach( function(xx, i) {\n      if (y>yMax) {\n        return RectCount\n      }\n      if (x>xMax) {\n        x = xMin - dx/2;\n        y = y + dy;\n      } else {\n        // Do something\n        var count = 0\n        d3.range(xData.length).forEach(function(xx, i) {\n          if (xData[xx]>=x && xData[xx]<(x+dx) && yData[xx]>=y && yData[xx]<(y+dy)){\n            count = count + 1\n          }\n        });\n        if (count>0) {\n          RectCount.push({\"x\": x, \"y\": y, \"c\": Math.log10(count)});\n        }\n        x = x + dx;\n      }\n    });\n    return RectCount\n  }\n\n  var inningsColor = []\n  d3.range(data.length).forEach(function(xx, i) {\n      if (data[xx].Name==chosen_batter) {\n        d3.range(data.length).forEach(function(yy, j) {\n          if (data[xx].Won[yy]==\"Yes\"){\n            inningsColor.push(\"#B4BA39\");\n          } else {\n            inningsColor.push(\"#FF6B6C\");\n          }\n        });\n      }\n  });\n\n  function drawPoints(in_data) {\n    // Select all circles in the group and append a data point to each\n\n    var rectCounts = rectBinner(in_data[0], in_data[1], dx, dy)\n    const color = d3.scaleSequential(d3.interpolateGreys)\n        .domain([0, d3.max(rectCounts, d => d.c) / 2]);\n\n    baseCirclesGroup.append(\"g\")\n      .attr(\"stroke\", \"#000\")\n      .attr(\"stroke-opacity\", 0.2)\n    .selectAll(\"rect\")\n    .data(rectCounts)\n    .join(\"rect\")\n      // .attr(\"transform\", d => `translate(${d.x},${d.y})`)\n      .attr('x', d => xScale(d.x))\n      .attr('y', d => yScale(d.y))\n      .attr('width', xScale(dx)-xScale(0))\n      .attr('height', yScale(0)-yScale(dy))\n      .attr(\"fill\", d => color(d.c))\n      .attr(\"opacity\", 0.75);\n\n    d3.range(data.length).forEach(function(xx, i) {\n      if (data[xx].Name==chosen_batter) {\n        d3.range(data.length).forEach(function(yy, j) {\n          baseCirclesGroup\n            .append('circle')\n            .attr(\"class\", \"innings_circles\")\n            .attr(\"cx\", xScale(data[xx].SR[yy]+(d3.randomUniform(1)()-1)/2))\n            .attr(\"cy\", yScale(data[xx].Balls[yy]+(d3.randomUniform(1)()-1)/2))\n            .attr(\"fill\", data[xx].Won[yy]==\"Yes\"? \"#B4BA39\": \"#FF6B6C\")\n            .attr(\"r\", 4)\n            .attr('stroke', \"#ffffff\")\n            .attr('stroke-width', 1)\n            .attr('opacity', 0.75)\n            // Interactive functions:\n            .on(\"mouseenter\", function(e){\n              mouseEnter(e, yy)\n            })\n            .on(\"mouseleave\", function(e){\n              mouseLeave(e, yy)\n            });\n            // .on(\"click\", clicked);\n        });\n         \n      }\n    });\n  }\n\n  // Function to draw equi-run lines, given an array of runs\n  var line = d3.line()\n  var SR_linspace\n  function drawEquiRunLines(eqrs) {\n    SR_linspace = d3.ticks(xScale.domain()[0], xScale.domain()[1], 1000);    \n    var balls_eqr\n    var eqr_points\n    // Equi-run lines\n    for (let j = 0; j < eqrs.length; j++) { \n      balls_eqr = new Array();\n      eqr_points = new Array();\n      for (let i = 0; i < SR_linspace.length; i++) { \n        balls_eqr.push(eqrs[j]*100/SR_linspace[i]);\n        if (balls_eqr[i]>=yScale.domain()[0] && balls_eqr[i]<=yScale.domain()[1]) {\n          eqr_points.push([xScale(SR_linspace[i]), yScale(balls_eqr[i])]);\n        }\n        \n      }\n\n      g.append('path')\n        .attr(\"class\", \"main_eqr_lines\")\n        .attr('d', line(eqr_points))\n        .attr('stroke', '#a3a3a3')\n        .style(\"stroke-dasharray\", (\"10,3\"))\n        .attr('fill', 'none');\n\n      // Labeling the equi-run lines on the right-side of the plot\n      g.append(\"text\")\n        .attr(\"class\", \"main_eqr_run_labels\")\n        .attr(\"dx\", \"0.5em\")\n        .attr(\"font-family\", \"roboto\")\n        .attr(\"font-size\", 15)\n        .attr(\"fill\", textColor)\n        .attr(\"y\", yScale(eqrs[j]*100/(xScale.domain()[1]))) // offset it from the edge of the rectangle\n        .attr(\"x\", xScale(xScale.domain()[1])) // offset it from the edge of the rectangle\n        .attr(\"dominant-baseline\", \"middle\")\n        .text(d3.format(\".0f\")(eqrs[j])+\" runs\");\n    }\n  }\n\n  // Calling function to draw equi-run lines\n  drawEquiRunLines([10, 20, 30, 40, 50, 60, 75, 100])\n\n  drawPoints([all_SR, all_balls], chosen_batter);\n\n  function getFirstLetters(str) {\n    const firstLetters = str\n      .split(' ')\n      .map(word => word[0])\n      .join('');\n\n    return firstLetters;\n  }\n\n  function mouseEnter(event, yy) {\n    \n    // Change opacity of all scatter points on hover\n    baseCirclesGroup.selectAll('circle')\n      .attr(\"stroke\", \"none\")\n      .attr(\"opacity\", 0.75)\n      .attr(\"fill\", \"#d3d3d3\");\n\n    tooltip.select(\"#tp\")\n      .raise();\n\n    const xPos = 0.8*xScale(xScale.domain()[1])\n    const yPos = 0.1*yScale(yScale.domain()[0])\n    tooltip\n      .attr(\"transform\", `translate(${xPos},${yPos})`)\n      .attr(\"visibility\", \"visible\");\n\n    d3.range(data.length).forEach(function(xx, i) {\n      if (data[xx].Name==chosen_batter) {\n        tooltip.append(\"text\")\n          .attr(\"dy\", \"0em\")\n          .attr(\"font-family\", \"roboto\")\n          .attr(\"font-size\", 20)\n          .attr(\"fill\", greyTextColor)\n          .attr(\"font-weight\", \"bold\")\n          .attr(\"dominant-baseline\", \"hanging\")\n          .text(data[xx].Name);\n\n        tooltip.append(\"text\")\n          .attr(\"dy\", \"1.1em\") // you can vary how far apart it shows up\n          .attr(\"font-family\", \"roboto\")\n          .attr(\"font-size\", 18)\n          .attr(\"fill\", greyTextColor)\n          .attr(\"dominant-baseline\", \"hanging\")\n          .text(data[xx].Runs[yy]+\" (\"+data[xx].Balls[yy]+\")\");\n\n        tooltip.append(\"text\")\n          .attr(\"dy\", \"2.6em\") // you can vary how far apart it shows up\n          .attr(\"font-family\", \"roboto\")\n          .attr(\"font-size\", 15)\n          .attr(\"fill\", greyTextColor)\n          .attr(\"dominant-baseline\", \"hanging\")\n          .text(getFirstLetters(data[xx].Team[yy])+\" vs \"+getFirstLetters(data[xx].OppTeam[yy])+\" (\"+data[xx].TeamType[yy]+\")\");\n        \n        tooltip.append(\"text\")\n          .attr(\"dy\", \"3.7em\") // you can vary how far apart it shows up\n          .attr(\"font-family\", \"roboto\")\n          .attr(\"font-size\", 15)\n          .attr(\"fill\", greyTextColor)\n          .attr(\"dominant-baseline\", \"hanging\")\n          .text(data[xx].Date[yy]);\n\n        event.target.r.baseVal.value = 12\n        event.target.style.opacity = 1\n        event.target.style.fill = data[xx].Won[yy]==\"Yes\"? \"#B4BA39\": \"#FF6B6C\"\n         event.target.style.stroke = \"#ffffff\"\n      }\n    });\n  }\n\n  function mouseLeave(event) {\n    tooltip.attr(\"visibility\", \"hidden\");\n    tooltip.selectAll(\"text\").remove()\n    baseCirclesGroup.selectAll(\".innings_circles\").remove()\n    d3.range(data.length).forEach(function(xx, i) {\n      if (data[xx].Name==chosen_batter) {\n        d3.range(data.length).forEach(function(yy, j) {\n          baseCirclesGroup\n            .append('circle')\n            .attr(\"class\", \"innings_circles\")\n            .attr(\"cx\", xScale(data[xx].SR[yy]+(d3.randomUniform(1)()-1)/2))\n            .attr(\"cy\", yScale(data[xx].Balls[yy]+(d3.randomUniform(1)()-1)/2))\n            .attr(\"fill\", data[xx].Won[yy]==\"Yes\"? \"#B4BA39\": \"#FF6B6C\")\n            .attr(\"r\", 4)\n            .attr('stroke', \"#ffffff\")\n            .attr('stroke-width', 1)\n            .attr('opacity', 0.75)\n            // Interactive functions:\n            .on(\"mouseenter\", function(e){\n              mouseEnter(e, yy)\n            })\n            .on(\"mouseleave\", function(e){\n              mouseLeave(e, yy)\n            });\n        });\n         \n      }\n    });\n\n  }\n  return svg.node();\n}\n"},{"methodName":"interpretQuiet","source":"shinyInput('chosen_batter')"}]}
</script>
<script type="module">
window._ojs.paths.runtimeToDoc = "../../projects/cricket_analytics/ipl_batters_strategies";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Copyright 2023 Roshan Prizak. Except where otherwise noted, all text and images licensed CC-BY-NC 4.0.</div>   
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","selector":".lightbox","loop":true,"openEffect":"zoom"});</script>



</body></html>